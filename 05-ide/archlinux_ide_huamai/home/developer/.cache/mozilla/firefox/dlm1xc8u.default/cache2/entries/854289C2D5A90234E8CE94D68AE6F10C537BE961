!function e(t,i,o){function n(a,s){if(!i[a]){if(!t[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(r)return r(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var l=i[a]={exports:{}};t[a][0].call(l.exports,function(e){var i=t[a][1][e];return n(i?i:e)},l,l.exports,e,t,i,o)}return i[a].exports}for(var r="function"==typeof require&&require,a=0;a<o.length;a++)n(o[a]);return n}({1:[function(e,t,i){var o={weixin:{appid:_WIZ_CONFIG.weixin.appid,qrcode:{url:"https://open.weixin.qq.com/connect/qrconnect?appid=$1&redirect_uri=&2&response_type=code&scope=snsapi_login&state=$3#wechat_redirect"},bind:{url:_WIZ_CONFIG.url.as+"/wx/bind",action:"post"},autoLogin:{url:_WIZ_CONFIG.url.weixin+"/biz/refresh_token",action:"get"},smsCaptcha:{url:_WIZ_CONFIG.url.as+"/users/sms_captcha",action:"get"},mobileLogin:{url:_WIZ_CONFIG.url.weixin+"/biz/mobile_login",action:"post"},getUsage:{url:_WIZ_CONFIG.url.weixin+"/biz/usage",action:"get"},addUsage:{url:_WIZ_CONFIG.url.weixin+"/biz/usage",action:"post"},searchDocumentList:{url:_WIZ_CONFIG.url.weixin+"/biz/search",action:"get"}},user:{autoLogin:{url:_WIZ_CONFIG.url.ks+"/login",action:"post"},keepAlive:{url:_WIZ_CONFIG.url.as+"/users/ping",action:"post"},login:{url:"/api/login",action:"post"},logout:{url:"/api/logout",action:"post"},register:{url:_WIZ_CONFIG.url.as+"/users/signup",action:"post"},resetPassword:{url:_WIZ_CONFIG.url.as+"/users/reset_pwd",action:"post"},checkUserId:{url:_WIZ_CONFIG.url.as+"/users/is_pwd_set",action:"get"},userInfo:{url:_WIZ_CONFIG.url.as+"/users/get_info",action:"get"},changeUserId:{url:_WIZ_CONFIG.url.as+"/users/change_account",action:"post"},createBindOauth:{url:_WIZ_CONFIG.url.as+"/users/bind_wiz_account",action:"post"},updateUserInfo:{url:_WIZ_CONFIG.url.as+"/users/update_info",action:"post"},changePassword:{url:_WIZ_CONFIG.url.as+"/users/change_pwd",action:"post"},resendVerifyEmail:{url:_WIZ_CONFIG.url.as+"/users/resend_verify_email",action:"get"},verifyEmail:{url:_WIZ_CONFIG.url.as+"/users/verify_email",action:"get"},getInviteUserList:{url:_WIZ_CONFIG.url.as+"/users/get_invites",action:"get"},pay:{url:_WIZ_CONFIG.url.as+"/pay2/person",action:"post"},payByPoint:{url:_WIZ_CONFIG.url.as+"/pay/points",action:"get"},payByCard:{url:_WIZ_CONFIG.url.as+"/pay/card",action:"get"},validatePayCard:{url:_WIZ_CONFIG.url.as+"/pay/card/info",action:"get"},getPersonalPayLog:{url:_WIZ_CONFIG.url.as+"/pay/person/log?count=10",action:"get"},resetPasswordApply:{url:_WIZ_CONFIG.url.as+"/users/apply_reset_pwd",action:"get"}},biz:{bizInfo:{url:_WIZ_CONFIG.url.as+"/biz/info",action:"get"},extendTrial:{url:_WIZ_CONFIG.url.as+"/biz/extend_trial",action:"post"},createBiz:{url:_WIZ_CONFIG.url.as+"/biz/create",action:"post"},updateBiz:{url:_WIZ_CONFIG.url.as+"/biz/update",action:"post"},getBizList:{url:_WIZ_CONFIG.url.as+"/biz/user_bizs",action:"get"},addBizMember:{url:_WIZ_CONFIG.url.as+"/biz/add_users",action:"post"},updateBizMember:{url:_WIZ_CONFIG.url.as+"/biz/update_user",action:"post"},deleteBizMember:{url:_WIZ_CONFIG.url.as+"/biz/delete_users",action:"get"},getBizMemberList:{url:_WIZ_CONFIG.url.as+"/biz/get_users",action:"get"},getBizMemberListForAt:{url:_WIZ_CONFIG.url.ks+"/biz/user/list",action:"get"},finishBizGuide:{url:_WIZ_CONFIG.url.as+"/biz/init_biz",action:"get"},getPayPromote:{url:_WIZ_CONFIG.url.as+"/pay2/promo_code/get_info",action:"get"},getPromoOrdersLog:{url:_WIZ_CONFIG.url.as+"/pay2/promo_code/orders",action:"get"},getPayCoupon:{url:_WIZ_CONFIG.url.as+"/pay2/coupon/get_info",action:"get"},pay:{url:_WIZ_CONFIG.url.as+"/pay2/biz",action:"post"},getPayOrderInfo:{url:_WIZ_CONFIG.url.as+"/pay2/order",action:"get"},getBizPayLog:{url:_WIZ_CONFIG.url.as+"/pay/biz/log",action:"get"}},group:{createBizGroup:{url:_WIZ_CONFIG.url.as+"/groups/create",action:"post"},createPersonalGroup:{url:_WIZ_CONFIG.url.ks+"/user/createPersonalGroup",action:"post"},updateGroup:{url:_WIZ_CONFIG.url.as+"/groups/update",action:"post"},deleteGroup:{url:_WIZ_CONFIG.url.as+"/groups/delete",action:"get"},getBizGroupList:{url:_WIZ_CONFIG.url.as+"/groups",action:"get"},getAllGroupList:{url:_WIZ_CONFIG.url.as+"/groups",action:"get"},createDefaultDocument:{url:_WIZ_CONFIG.url.ks+"/document/createDefault",action:"get"},createGroupCategory:{url:_WIZ_CONFIG.url.ks+"/tag/items",action:"post"},getGroupMemberList:{url:_WIZ_CONFIG.url.as+"/groups/get_users",action:"get"},addGroupMember:{url:_WIZ_CONFIG.url.as+"/groups/add_users",action:"post"},deleteGroupMember:{url:_WIZ_CONFIG.url.as+"/groups/delete_users",action:"post"},groupStorage:{url:_WIZ_CONFIG.url.ks+"/kb/info",action:"get"},quitGroup:{url:_WIZ_CONFIG.url.as+"/groups/quit",action:"get"}},oauth:{bind:{sina:_WIZ_CONFIG.url.as+"/openid2/bind?st=sina",taobao:_WIZ_CONFIG.url.as+"/openid2/bind?st=taobao",qq:_WIZ_CONFIG.url.as+"/openid2/bind?st=qq",kuaipan:_WIZ_CONFIG.url.as+"/openid2/bind?st=kuaipan",renren:_WIZ_CONFIG.url.as+"/openid2/bind?st=renren"},unbind:{sina:{url:_WIZ_CONFIG.url.as+"/openid2/unbind?st=sina",action:"get"},taobao:{url:_WIZ_CONFIG.url.as+"/openid2/unbind?st=taobao",action:"get"},qq:{url:_WIZ_CONFIG.url.as+"/openid2/unbind?st=qq",action:"get"},weixin:{url:_WIZ_CONFIG.url.as+"/openid2/unbind?st=weixin",action:"get"},kuaipan:{url:_WIZ_CONFIG.url.as+"/openid2/unbind?st=kuaipan",action:"get"},renren:{url:_WIZ_CONFIG.url.as+"/openid2/unbind?st=renren",action:"get"}},login:{url:_WIZ_CONFIG.url.as+"/openid2/auth_code",action:"post"},signup:{url:_WIZ_CONFIG.url.as+"/openid2/oauth_signup",action:"post"}},doc:{getMessage:{url:"/wizmessage/messages",action:"get"},setMessageStatus:{url:"/wizmessage/messages/status",action:"post"},deleteMessage:{url:"/wizmessage/messages",action:"delete"},getAllCategory:{url:_WIZ_CONFIG.url.ks+"/category/all",action:"get"},addCategory:{url:_WIZ_CONFIG.url.ks+"/category/item",action:"post"},deleteCategory:{url:_WIZ_CONFIG.url.ks+"/category/item",action:"delete"},renameCategory:{url:_WIZ_CONFIG.url.ks+"/category/item",action:"put"},getAllTag:{url:_WIZ_CONFIG.url.ks+"/tag/all",action:"get"},addTag:{url:_WIZ_CONFIG.url.ks+"/tag/item",action:"post"},deleteTag:{url:_WIZ_CONFIG.url.ks+"/tag/item",action:"delete"},renameTag:{url:_WIZ_CONFIG.url.ks+"/tag/item",action:"put"},getDocumentList:{url:_WIZ_CONFIG.url.ks+"/document/list",action:"get"},getDocumentSummary:{url:"/wizsearch/abstract",action:"get"},getDocumentInfo:{url:_WIZ_CONFIG.url.ks+"/document/info",action:"get"},getDocumentData:{url:_WIZ_CONFIG.url.ks+"/document/body",action:"get"},createTmpDocument:{url:_WIZ_CONFIG.url.ks+"/document/data",action:"post"},updateDocument:{url:_WIZ_CONFIG.url.ks+"/document/data",action:"put"},deleteDocument:{url:_WIZ_CONFIG.url.ks+"/document/data",action:"delete"},getEditCounter:{url:_WIZ_CONFIG.url.ks+"/counter/get",action:"get"},addEditCounter:{url:_WIZ_CONFIG.url.ks+"/counter/add",action:"get"},deleteEditCounter:{url:_WIZ_CONFIG.url.ks+"/counter/delete",action:"get"},getHistory:{url:_WIZ_CONFIG.url.ks+"/document/history",action:"get"},getDeletedList:{url:_WIZ_CONFIG.url.ks+"/document/deleted_list",action:"get"},restoreHistory:{url:_WIZ_CONFIG.url.ks+"/document/restore",action:"get"},recycle:{url:_WIZ_CONFIG.url.ks+"/document/recycle",action:"get"},getAttachmentList:{url:_WIZ_CONFIG.url.ks+"/attachment/list",action:"get"},deleteAttachment:{url:_WIZ_CONFIG.url.ks+"/attachment/data",action:"delete"},attachmentUpload:{url:_WIZ_CONFIG.url.ks+"/attachment/data"},getCommentList:{url:_WIZ_CONFIG.url.ks+"/comment/list",action:"get"},getCommentCount:{url:_WIZ_CONFIG.url.ks+"/comment/count",action:"get"},createComment:{url:_WIZ_CONFIG.url.ks+"/comment/create",action:"post"},deleteComment:{url:_WIZ_CONFIG.url.ks+"/comment/delete",action:"post"}},share:{cancel:{url:"/share/api/shares/$1",action:"delete"},create:{url:"/share/api/shares",action:"post"},update:{url:"/share/api/shares/$1",action:"put"},getMyShare:{url:"/share/api/shares",action:"get"}},weibo:{bind:{url:_WIZ_CONFIG.url.as+"/weibo_fans/bind",action:"post"}}};t.exports=o},{}],2:[function(e,t,i){var o={"wizBox-20150504":{startDate:new Date(2015,4,4),endDate:new Date(2015,5,5),url:"/pages/poster/wizBox-20150504/index.html"}};t.exports=o},{}],3:[function(e,t,i){var o=wizUI.util.getLocale(),n=(new Date).valueOf(),r={libs:{githubCss:"/libs/component/pagedown/github2.f957e500.css",prettifyJs:"/libs/component/pagedown/prettify.83028912.js",mathJax:location.protocol+"//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"},common:{bizLogin:"/pages/login.html",login:_WIZ_CONFIG.url.login,captchaImg:_WIZ_CONFIG.url.as+"/captcha/",resetPasswordApply:"/pages/manage/person/reset_pwd_apply.html",noteFullScreen:"/pages/wiz-flat-doc.html",noteFullScreenForMobile:"/pages-mobile/wiz-flat-doc.html",appDownload:_WIZ_CONFIG.url.website+"/download.html",invitedURL:"https://note.wiz.cn/i/",shareURL:"http://fromwiz.com/share/s/",zeroclipboardSwf:"/libs/component/zeroclipboard/zeroclipboard.92440710.swf"},user:{iconBase:_WIZ_CONFIG.url.as+"/users/avatar/",note:_WIZ_CONFIG.url.wizNote,noteGroupList:_WIZ_CONFIG.url.wizNote+"?gidx=1",account_setting:"/pages/manage/person/account.html?p=setting",inviteFriend:"/pages/manage/person/account.html?p=invite",vipPrice:"/pages/manage/person/account.html?p=vip",userPay:"/pages/manage/biz/userPay.html",payData:"/libs/wizData/"+o+"/userpay.json?"+n,oauth:"/pages/manage/person/oauth.html",oauthAPI:_WIZ_CONFIG.url.as+"/openid2/bind",bdshareUrl:_WIZ_CONFIG.url.website},personal:{groupCreate:"/pages/manage/biz/personalGroupCreate.html",groupManage:"/pages/manage/biz/personalGroupManage.html",helpDoc:_WIZ_CONFIG.url.website+"/manual/web"},biz:{guideData:"/libs/wizData/"+o+"/bizTypeData.json?"+n,authIntroData:"/libs/wizData/"+o+"/authIntro.json?"+n,guide:"/pages/manage/biz/bizGuide.html",helpDoc:_WIZ_CONFIG.url.website+"/manual/web/teamwork-web.html",manage:"/pages/manage/biz/bizManage.html",groupCreate:"/pages/manage/biz/bizGroupCreate.html",groupManage:"/pages/manage/biz/bizGroupManage.html",payData:"/libs/wizData/"+o+"/bizpay.json?"+n,pay:"/pages/manage/biz/bizPay.html",extendTrial:"/pages/manage/biz/extendTrial.html",oemManage:"/manage_console"},doc:{history:"/pages/manage/doc/history.html"},note_mobile:{main:"/pages-mobile/wiz-flat.html",docInfo:"/pages-mobile/wiz-flat-doc.html"},wx:{main:"/pages-mobile/weixin/index.html",docInfo:"/pages-mobile/weixin/doc.html"},pay:{aliPay:"https://mapi.alipay.com/gateway.do",payPal:"https://www.sandbox.paypal.com/cgi-bin/webscr?cmd=_express-checkout&useraction=commit",paySuccess:"/pages/manage/biz/paySuccess.html"},biz_mobile:{guide:"/pages-mobile/manage/biz/bizGuide.html",manage:"/pages-mobile/manage/biz/bizManage.html",groupCreate:"/pages-mobile/manage/biz/bizGroupCreate.html",groupManage:"/pages-mobile/manage/biz/bizGroupManage.html"},blogInfo:{userVip:"http://blog.wiz.cn/wiz-vip.html",userPoint:"http://blog.wiz.cn/user_points.html",userLevel:"http://blog.wiz.cn/user_level.html",bizUpgradeInfo:"http://blog.wiz.cn/wiznote-biz-pricing.html",mywizEmailInfo:"http://blog.wiz.cn/wiz-mywiz.html",weiboBindUser:"http://blog.wiz.cn/ios-weibo-collection.html",weixinBindUser:"http://blog.wiz.cn/ios-wechat-collection.html",wizBizTerm:"http://blog.wiz.cn/wiz-service.html",wizBizPromo:"http://blog.wiz.cn/pay-promo.html",payProblem:"http://blog.wiz.cn/pay-more.html",payProblemVIP:"http://blog.wiz.cn/pay-more-vip.html",support:"http://www.wiz.cn/support.html",wizTeamRoleAuth:"http://blog.wiz.cn/team-role-auth.html",fuckIE:"http://blog.wiz.cn/ieupdate.html",tel:"tel:4008258085",commentMarkdown:"http://blog.wiz.cn/wiz-comment-markdown.html",usePromoCode:"http://blog.wiz.cn/pay-promo.html"},download:{Windows:"http://misc.wiz.cn/download?product=wiznote&client=windows-x86",Mac:"https://itunes.apple.com/cn/app/wiznote/id863771545?l=zh&ls=1&mt=12",Linux:"http://blog.wiz.cn/downloads-mac-linux.html","default":"https://note.wiz.cn/login"},other:{wizWeibo:"http://weibo.com/wiz2011"}};t.exports=r},{}],4:[function(e,t,i){var o=e("./api"),n=e("./url"),r=e("./poster"),a=_WIZ_CONFIG.oem.getData("CustomInfo"),s={companyInfo:{hotline:a?a.customer_hotline:"400-825-8085"},event:{},style:{wizWebFlat:"wizWebFlat",wizWebFlatMobile:"wizWebFlatMobile",wizWebFlatDoc:"wizWebFlatDoc",wizWeixin:"wizWeixin",clientComment:"clientComment",resetPassword:"wizResetPassword",myShare:"wizMyShare",myShareSetting:"wizMyShareSetting",account:"account",docHistory:"docHistory",docRecycle:"docRecycle",oauth:"oauth",bindWeibo:"bindWeibo",bizLogin:"bizLogin",bizGuide:"bizGuide",bizManage:"bizManage",bizPay:"bizPay",groupCreate:"groupCreate",personalGroupCreate:"personalGroupCreate",personalGroupManage:"personalGroupManage",bizGroupCreate:"bizGroupCreate",bizGroupManage:"bizGroupManage"},clientType:"webFrame",note:{initDoc:{body:'<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8">$1</head><body>$2</body></html>',cssId:"wiz_custom_css",cssForEdit:"html, body {height: 100%;margin: 0;-webkit-box-sizing: border-box;-moz-box-sizing: border-box;box-sizing: border-box;}html {padding: 0;} body{padding: 8px;}",css:'body{font-family: "Microsoft YaHei UI","Microsoft YaHei",SimSun,"Segoe UI",Tahoma,Helvetica,Sans-Serif,"Microsoft YaHei", Georgia,Helvetica,Arial,sans-serif,宋体, PMingLiU,serif;font-size: 10.5pt;line-height: 1.5;}html, body {}h1, h2, h3, h4, h5, h6 {font-weight:bold;}h1 {font-size:1.5em;}h2 {font-size:1.4em;}h3 {font-size:1.3em;}h4 {font-size:1.2em;}h5 {font-size:1.1em;}h6 {font-size:1.0em;}img {border:0;max-width: 100%;}blockquote {margin-top:0px;margin-bottom:0px;}table {border-collapse:collapse;border:1px solid #bbbbbb;}td {border-collapse:collapse;border:1px solid #bbbbbb;}'},autoSave:3e3,maxFileSize:_WIZ_CONFIG.oem.getData("Web_MaxFileSize")||5,pay:{wizRemittanceAccount:"0200003809068098972",vipPoints:1e3},kb:{personal:"personal",myGroup:"myGroup",bizGroup:"bizGroup",msg:"message"},msgType:{all:"-",at:0,commented:10,modified:1,unRead:"-r"},menuType:{messageCenter:"messageCenter",lastModify:"lastModify",search:"search",category:"category",tag:"tag",myShare:"myShare"},menuCmd:{create:"create",noTag:"noTag"},docListTypeParams:{keyword:"kw",category:"ca",tag:"tg",noTag:"ntg",msg:"msg",myShare:"myShare"},docListType:{Msg:"msg",msg:"msg",Search:"keyword",kw:"keyword",Category:"category",ca:"category",Tag:"tag",tg:"tag",NoTag:"noTag",ntg:"noTag",myShare:"myShare"},emptyType:{msgUnReadIsEmpty:"msgUnReadIsEmpty",msgIsEmpty:"msgIsEmpty",docLastIsEmpty:"docLastIsEmpty",docSearchIsEmpty:"docSearchIsEmpty",docCategoryIsEmpty:"docCategoryIsEmpty",docTagIsEmpty:"docTagIsEmpty",docNotFound:"docNotFound"},share:{limitValue:{days:7,times:300},limitRange:{days:{max:1e3,min:1},times:{min:1,max:1e3}},weibo:{appkey:3957573307,ralateUid:1920682763,title:"Hi，我分享了一篇文章 “$1”，来看看吧！"}}},authority:{biz:{nameList:["owner","admin","user"],codeList:[0,10,1e3],0:"owner",10:"admin",100:"hr",1000:"user",10000:"guest",owner:0,admin:10,hr:100,user:1e3,guest:1e4,defaultCode:1e3},group:{nameList:["admin","super","editor","author","reader"],codeList:[0,10,50,100,1e3],0:"admin",10:"super",50:"editor",100:"author",1000:"reader",admin:0,"super":10,editor:50,author:100,reader:1e3,defaultCode:50}},memberMaxCount:{biz:{0:10,1:10,2:1/0,3:1/0}},groupMaxCount:{biz:{maxLevel:_WIZ_CONFIG.oem.getData("MaxBizLevel")||3,0:_WIZ_CONFIG.oem.getData("MaxGroupCount_Biz0")||2,1:_WIZ_CONFIG.oem.getData("MaxGroupCount_Biz1")||5,2:_WIZ_CONFIG.oem.getData("MaxGroupCount_Biz2")||10,3:_WIZ_CONFIG.oem.getData("MaxGroupCount_Biz3")||1/0},personal:{free:_WIZ_CONFIG.oem.getData("MaxGroupCount_PersonFree")||2,vip:_WIZ_CONFIG.oem.getData("MaxGroupCount_PersonVip")||5}},comment:{maxLetterCount:1500},pageFrame:{account:{setting:"setting",vip:"vip",invite:"invite",sns:"sns"},accountVip:{points:"points",vipCard:"vipCard"},recycle:{doc:"doc",attachment:"attachment"},oauth:{success:"wiznote_oauth_success",fail:"fail",nobind:"nobind",bind:"bind",create:"create",login:"login"},biz:{groupList:"grouplist",memberList:"memberlist",bizInfo:"bizinfo",payment:"payment"}},modelStamp:{MessageList:"MessageList",DocMessageList:"docMessageList",LeftCategoryTree:"leftCategoryTree",LeftTagPTree:"leftTagPTree",LeftTagGTree:"leftTagGTree",DocSummaryList:"docSummaryList",DocInfo:"docInfo",DocTagName:"docTagName",DocComment:"docComment",DocAttachment:"docAttachment",DocEditTagTree:"editTagTree",DocEditCategoryTree:"editCategoryTree",DocEditAllTags:"editAllTags",DocEditTagName:"editTagName",BizUserListForAt:"BizUserListForAt"},sysMsg:{Type:{Error:"error",Warning:"warning",Success:"success"}},confirm:{Space:5,Type:{UpLeft:"up-left",DownLeft:"down-left",LeftUp:"left-up",RightUp:"right-up",UpRight:"up-right",DownRight:"down-right",LeftDown:"left-down",RightDown:"right-down"}},pointType:{create_biz:"createBiz",login_web:"loginFirst",login_pc:"loginFirst",sync_daily:"syncDaily",pay_first:"payFirst",invite_verify_email:"invitedUserVerifyEmail",invite_signup:"inviteUser",manual:"manual"},globalTimer:300,dataOperateType:{GetBizMessage:"d_getBizMessage",SetBizMessageStatus:"d_setBizMessageStatus",DeleteBizMessage:"d_deleteBizMessage",MarkAllReadStatus:"d_markAllReadStatus",GetCategory:"d_getCategory",AddCategory:"d_addCategory",RenameCategory:"d_renameCategory",DeleteCategory:"d_deleteCategory",GetTags:"d_getTags",AddTag:"d_addTag",RenameTag:"d_renameTag",DeleteTag:"d_deleteTag",GetDocumentList:"d_getDocumentList",GetDocumentSummary:"d_getDocumentSummary",GetDocument:"d_getDocument",CreateDocument:"d_createDocument",SaveDocument:"d_saveDocument",DeleteDocument:"d_deleteDocument",CreateDefaultDocument:"d_createDefaultDocument",CreateGroupCategory:"d_createGroupCategory",GetEditCount:"d_getEditCount",AddEditCount:"d_addEditCount",DeleteEditCount:"d_deleteEditCount",GetAttachment:"d_getAttachment",DeleteAttachment:"d_deleteAttachment",GetCommentList:"wiz_getCommentList",AddComment:"wiz_addComment",DeleteComment:"wiz_deleteComment",GetDocumentHistory:"d_getDocumentHistory",RestoreDocumentHistory:"d_restoreDocumentHistory",GetDocumentBody:"d_getDocumentBody",GetDocumentDeleted:"d_getDocumentDeleted",GetAttachmentDeleted:"d_getAttachmentDeleted",RecycleDeleted:"d_recycleDeleted",CancelShareDocument:"d_cancelShareDocument",CreateShareDocument:"d_createShareDocument",UpdateShareDocument:"d_updateShareDocument",GetMyShareDocuments:"d_getMyShareDocuments",GetMyShareByDocGuid:"d_getMyShareByDocGuid",CreateBizInfo:"d_createBizInfo",UpdateBizInfo:"d_updateBizInfo",OnUpdateBizInfo:"on_d_updateBizInfo",AddBizMember:"d_addBizMember",OnAddBizMember:"on_d_addBizMember",DeleteBizMember:"d_deleteBizMember",UpdateBizMember:"d_updateBizMember",OnUpdateBizMember:"on_d_updateBizMember",GetBizMemberList:"d_getBizMemberList",GetBizPromoteInfo:"d_getBizPromoteInfo",GetPromoOrdersLog:"d_getPromoOrdersLog",GetBizCouponInfo:"d_getBizCouponInfo",GetBizMemberListForAt:"d_getBizMemberListForAt",BizPay:"d_bizPay",GetBizPayLog:"d_getBizPayLog",GetBizGroupList:"d_getBizGroupList",CreateBizGroup:"d_createBizGroup",CreatePersonalGroup:"d_createPersonalGroup",OnCreateBizGroup:"on_d_createBizGroup",OnCreateBizGroupToGroupManage:"on_d_createBizGroupToGroupManage",OnCreateBizGroupToBizManage:"on_d_crateBizGroupToGroupManage",DeleteGroup:"d_deleteBizGroup",OnDeleteGroup:"on_d_deleteBizGroup",UpdateGroup:"d_updateGroup",OnUpdateGroup:"on_d_updateGroup",AddGroupMember:"d_addGroupMember",DeleteGroupMember:"d_deleteGroupMember",OnUpdateGroupMember:"on_d_updateGroupMember",UpdateGroupMemberRole:"d_updateGroupMemberRole",OnUpdateGroupMemberRole:"on_d_updateGroupMemberRole",GetGroupMemberList:"d_getGroupMemberList",GetGroupMemberListWithAll:"d_getGroupMemberListWithAll",GetGroupStorage:"d_getGroupStorage",QuitGroup:"d_quitGroup",OnQuitGroup:"on_d_quitGroup",ResetPasswordApply:"d_resetPasswordApply",ResetPassword:"d_resetPassword",ResendVerifyEmail:"d_resendVerifyEmail",PersonalPayByPoint:"d_payByPoint",PersonalPayByCard:"d_payByCard",ValidatePersonalPayCard:"d_validatePayCard",GetPersonalPayLog:"d_getPersonPayLog",GetInviteUserList:"d_getInviteUserList",UpdateUserInfo:"d_updateUserInfo",ChangeUserId:"d_changeUserId",ChangePassword:"d_changePassword",CreateBindOauth:"d_createBindOauth",BindSNS:"d_bindSNS",UnBindSNS:"d_unbindSNS",UserPay:"d_userPay",OauthLogin:"d_oauthLogin",OauthBind:"d_oauthBind",OauthCreate:"d_oauthCreate",OauthAutoCreate:"d_oauthAutoCreate",WeiboFansBind:"d_weiboFansBind"},frameEventType:{EventManager:"wiz_eventManager",ForceClientRefresh:"forceClientRefresh",HideMainLoading:"wiz_hideMainLoadingMask",ShowWizFrame:"wiz_showWizFrame",ShowWizModal:"wiz_showWizModal",HideWizModal:"wiz_hideWizModal",ShowWizConfirm:"wiz_showWizConfirm",HideWizConfirm:"wiz_hideWizConfirm",ShowSidebar:"wiz_showSidebar",HideSidebar:"wiz_hideSidebar",ShowFullGroup:"wiz_showFullGroup",HideFullGroup:"wiz_hideFullGroup",MenuExpand:"wiz_menuExpand",MenuCollapse:"wiz_menuCollapse",SwitchKb:"wiz_switchKb",SwitchMsgCenter:"wiz_switchMsgCenter",ResetMenuTree:"wiz_resetMenuTree",AddCategoryAndTagMenuTree:"wiz_addCategoryAndTagMenuTree",RenameCategoryAndTagMenuTree:"wiz_renameCategoryAndTagMenuTree",RemoveCategoryAndTagMenuTree:"wiz_removeCategoryAndTagMenuTree",CreateTagFromDocView:"wiz_createTagFromDocView",ShowMsgDocList:"wiz_showMsgDocList",ShowDocument:"wiz_showDocument",EditDocument:"wiz_editDocument",RemoveDocument:"wiz_removeDocument",UpdateDocument:"wiz_updateDocument",SaveDocument:"wiz_saveDocument",AutoSaveDocument:"wiz_autoSaveDocument",ShowEmptyInfo:"wiz_showEmptyInfo",ShowMsgList:"wiz_showMsgList",UpdateMsgList:"wiz_updateMsgList",ShowGroupIndex:"wiz_showGroupIndex",HideGroupList:"wiz_hideGroupList",ShowDocList:"wiz_showDocList",ShowSearch:"wiz_showSearch",ShowMyShare:"wiz_showMyShare",FrameResizeTrigger:"wiz_frameResizeTrigger",FrameResize:"frameResize",UpdateShareDocument:"wiz_updateShareDocument",ShowAccountSetting:"wiz_showAccountSetting",ShowAccountVip:"wiz_showAccountVip",ShowAccountInvite:"wiz_showAccountInvite",ShowAccountSns:"wiz_showAccountSns",ShowCreateBindModal:"wiz_showCreateBindModal",ShowRecycleDoc:"wiz_showRecycleDoc",ShowRecycleAttachment:"wiz_showRecycleAttachment",ShowOauthSuccess:"wiz_showOauthSuccess",ShowOauthFail:"wiz_showOauthFail",ShowOauthNoBind:"wiz_showOauthNoBind",ShowOauthBind:"wiz_showOauthBind",ShowOauthCreate:"wiz_showOauthCreate",GuideStep:"wiz_guideStep",ShowStepLoading:"wiz_guideShowStepLoading",HideStepLoading:"wiz_guideHideStepLoading",ShowOnlyAuthTip:"wiz_onlyAuthTip",SwitchBiz:"wiz_switchBiz",ShowGroupList:"wiz_showGroupList",ShowBizMemberList:"wiz_showBizMemberList",ShowBizInfo:"wiz_showBizInfo",ShowPayment:"wiz_showPayment",ShowCreateGroup:"wiz_showCreateGroup",HideCreateGroup:"wiz_hideCreateGroup",ShowGroupMemberList:"wiz_showGroupMemberList",HideGroupMemberList:"wiz_hideGroupMemberList",ShowAddGroupMember:"wiz_showAddGroupMember",HideAddGroupMember:"wiz_hideAddGroupMember",ShowMemberCharacter:"wiz_showMemberCharacter",HideMemberCharacter:"wiz_hideMemberCharacter",ShowBizMemberAssign:"wiz_showBizMemberAssign",HideBizMemberAssign:"wiz_hideBizMemberAssign",ShowAuthList:"wiz_showAuthList",HideAuthList:"wiz_hideAuthList",AddGroup:"wiz_addGroup",AddBizMember:"wiz_addBizMember"}},u={CLIENT_TYPE:"web2.0",API_VERSION:4,KEEP_ALIVE_TIME_MS:27e4,AUTO_LOGIN_RETRY:3,GET_USER_INFO_RETRY:3},c={loadingWait:300,documentListAuto:18e4,messageListAuto:3e4,commentListAuto:3e4,editCountAuto:6e4,localStorageTimeout:144e5,clientCommentTimeout:6048e5,notifyWait:1e4},l={bound:13897608e5},d={click:"touchend"},g={click:"click"};s.pcEvent=g,s.mobileEvent=d,s.event=g,t.exports={api:o,remote:u,baseModel:c,url:n,poster:r,web:s,emailVerify:l}},{"./api":1,"./poster":2,"./url":3}],5:[function(e,t,i){var o=e("../mvc/controller/loginController");o.init()},{"../mvc/controller/loginController":7}],6:[function(e,t,i){function o(){return"undefined"==typeof wiz_browser_check}var n=e("locale"),r=e("../util/Class"),a=e("../util/GlobalUtil"),s=e("../../config/wizConf"),u=e("../database/wizCenter"),c=e("../viewer-common/urlOperator");window.Wiz=window.Wiz||{};var l=wizUI.util.getCookieOptions(),d=r.extend({init:function(){c.init(),wizUI.isPcClient&&$(document.body).removeClass("flat-scrollbar"),this.bindClientOpenURL($(document),null)},libs:{locale:n,util:a,wizConf:s,wizCenter:u},views:{groupList:null,user:null},models:{base:null,user:null,groupList:null,userList:null},wizInit:function(){if(o()){var t=_WIZ_CONFIG.oem.getData("LogoConfig")?_WIZ_CONFIG.oem.getData("LogoConfig"):null;t&&t.enable?$("img.logo-oem-common").attr({src:t.common}).removeClass("hide"):($(".logo.wiz-white").removeClass("hide"),$(".logo.wiz-grey").removeClass("hide")),a.renderLanguage(n),u.token=wizUI.util.cookie("token"),this.models.base=e("../model/BaseModel"),this.models.base.setController(this),this.globalTimer=e("../util/globalTimer"),this.globalEvent=e("../util/globalEvent"),this.sysMsg=new wizUI.SysMsg({ctn:$("#sys-msg-ctn"),itemTemplate:$("#sys-msg-item-tmpl").html(),max:3}),window.sysMsg=this.sysMsg}},initBackgroundData:function(){this.initPage()},initPage:function(){wizUI.Modal.init(),this.views.confirm=new wizUI.Confirm({okBtn:n.common.label.confirm,cancelBtn:n.common.label.cancel}),this.views.header=e("../viewer-common/header"),this.views.header.init(this),this.views.loading=e("../viewer-common/loading"),this.views.loading.init(this),$(document).trigger(s.web.frameEventType.EventManager,[s.web.frameEventType.HideMainLoading])},clearTokenCookie:function(){wizUI.util.cookie("token",null),wizUI.util.cookie("token",null,l)},clearCertNoCookie:function(){wizUI.util.cookie("CertNo",null),wizUI.util.cookie("CertNo",null,l)},clearCookie:function(){this.clearTokenCookie(),this.clearCertNoCookie()},logoff:function(){var e=this;this.models.user.logout({},function(){var t=s.url.common.login+"?p=login";e.clearCookie(),e.getWinRoot().location.href=t})},reLogin:function(e){e=e||{},u.checkToken()&&this.clearCookie();var t=e.userId?"&user_id="+encodeURIComponent(e.userId):"",i=this.getWinRoot();i.location.href=s.url.common.login+"?p=login&redirectUrl="+encodeURIComponent(i.location.href)+t},getWinRoot:function(){var e=window;try{for(;e.parent!==e;)e=e.parent}catch(t){}return e},showSetting:function(e,t){e&&(t=t||{},window.open(this.libs.util.addParamsToUrl(e,t)))},initBizExpired:function(e){function t(e){return Math.ceil((e-new Date)/864e5)}var i;i=t(e.due_date),e.expired=0>=i,e.expiredDay=i,document._initBizExpired||($(document).on("click",".wizExtendTrial",function(e){var t=$(e.target);location.href=t.attr("data-url")}),document._initBizExpired=!0)},alertBizExpired:function(e,t){function i(e){var t=e.biz_name;return t.length<20?t:t.substr(0,5)+"..."+t.substr(t.length-5)}function o(e,o){var r=0>=o,s=e.biz_level,u={msg:"",auto:1e4};return u.msg=0!==s||r?0===s&&r?n.bizInfo.expired.bizFree+a.getExtendTrialHtml(e,n):r?n.bizInfo.expired.bizVip:n.bizInfo.expired.bizVipSoon:n.bizInfo.expired.bizFreeSoon+a.getExtendTrialHtml(e,n),t&&(u.msg="["+i(e)+"] "+u.msg),-3>o&&(u.showRnd=[100,20]),u}var r=e?e.expiredDay:1/0,s=7;s>=r&&this.showWarningMessage(o(e,r))},checkBizExpired:function(e){if(e&&e.expired){var t=0===e.biz_level?a.getExtendTrialHtml(e,n):"";return this.showWarningMessage({msg:n.bizInfo.expired.warning+t,auto:1e4}),!1}return!0},getBizGuid:function(){var e=u.bizInfo?u.bizInfo.biz_guid:null;return e=e||wizUI.util.getUrlParam("biz")||""},goGuide:function(e){var t={biz:e?"":this.getBizGuid()};wizUI.isAppStore&&(t.appstore=1),window.location=wizUI.util.setUrlParams(s.url.biz.guide,t)},goVip:function(){var e={biz:this.getBizGuid(),p:"payment"};wizUI.isAppStore&&(e.appstore=1),window.location=wizUI.util.setUrlParams(s.url.biz.manage,e)},goManage:function(){var e={};wizUI.isWizClient||wizUI.isWizWebClient?(e.biz=this.getBizGuid(),wizUI.isAppStore&&(e.appstore=1),window.location=wizUI.util.setUrlParams(s.url.biz.manage,e)):(e.mod="bizmanager",u.groupList&&u.groupList.length&&u.groupList[0]&&(e.kb=u.groupList[0].kbGuid),window.location=wizUI.util.setUrlParams(s.url.user.note,e))},confirmMessage:function(e,t){var i=e.type||s.web.sysMsg.Type.Warning;e.header=n.common.label[i],this.views.confirm.show(e,t)},showErrorMessage:function(e){e.type=s.web.sysMsg.Type.Error,e.showDrop=!0,this.sysMsg.addMsg(e)},showWarningMessage:function(e){e.type=s.web.sysMsg.Type.Warning,e.showDrop=!0,this.sysMsg.addMsg(e)},showSuccessMessage:function(e){e.type=s.web.sysMsg.Type.Success,e.showDrop=!0,this.sysMsg.addMsg(e)},wizStyle:function(){},initBlogLink:function(){var e,t,i,o=$(".blogInfoLink");for(e=0,t=o.length;t>e;e++)i=o.get(e),i.href=s.url.blogInfo[i.getAttribute("data-blog")]},bindClientOpenURL:function(e,t){function i(e){var t=$(e.currentTarget),i=t.attr("href")||"";/^wiz:/.test(i)&&(wizUI.util.openWizLink(a.parseWizLink(i,!1)),wizUI.util.stopBubble(e),wizUI.util.stopDefault(e))}function o(e){var i=$(e.currentTarget),o=i.attr("href")||"";if(o&&o.indexOf("javascript:")<0&&0!==o.indexOf("#")){if(location.origin||(location.origin=location.protocol+"//"+location.host),0===o.indexOf("/")?o=location.origin+o:o.indexOf("wiz")<0&&o.indexOf("http")<0&&o.indexOf("https")<0&&o.indexOf("mailto:")<0&&(o=location.origin+location.pathname+"/"+o),/^(http|https|wiz|wiznote):/.test(o)&&"_blank"!==i.attr("target")&&"_blank"!==t)return;/^(wiz|wiznote):/.test(o)?wizUI.util.openWizLink(wizUI.isWizClient?o:a.parseWizLink(o,!1)):window.open(o),wizUI.util.stopBubble(e),wizUI.util.stopDefault(e)}}wizUI.isWizClient||wizUI.isWizWebClient?e.find("body").on("click","a",o):e.find("body").on("click","a",i),this.unbindClientOpenURL=function(e){e.find("body").off("click","a",o)}}});t.exports=d},{"../../config/wizConf":4,"../database/wizCenter":9,"../model/BaseModel":10,"../util/Class":14,"../util/GlobalUtil":15,"../util/globalEvent":16,"../util/globalTimer":17,"../viewer-common/header":19,"../viewer-common/loading":20,"../viewer-common/urlOperator":21,locale:"locale"}],7:[function(e,t,i){var o,n,r,a=e("./baseController"),s=e("../database/wizCenter"),u=e("../database/remote"),c=a.extend({wizStyle:function(){return this.libs.wizConf.web.style.bizLogin},wizInit:function(){o=wizUI.util.getUrlParam("p"),n="reg"==o,r="login"==o,s.userId=wizUI.util.getUrlParam("email")||wizUI.util.getUrlParam("user_id"),!s.userId&&(location.search.indexOf("email=")>-1||location.search.indexOf("user_id=")>-1)?wizUI.util.cookie("wizID",null,wizUI.util.getCookieOptions()):s.userId||(s.userId=wizUI.util.cookie("wizID")||""),wizUI.util.getUrlParam("user_id")||wizUI.util.cookie("isinvited",null,wizUI.util.getCookieOptions()),this._super.apply(this,arguments),u.init(this),this.models.user=e("../model/UserInfo"),this.checkToken()},checkToken:function(){var e=this;return s.token?void this.models.user.getBase({},"",function(t){(!t||s.userId&&t&&t.user_id.toLowerCase()!=s.userId.toLowerCase())&&(s.token=null),e.getTokenByCertNo()}):void this.getTokenByCertNo()},getTokenByCertNo:function(){var e=this;return!s.token&&wizUI.util.cookie("CertNo")?void this.models.user.loginByCertNo(function(){e.checkUserId()}):void this.checkUserId()},checkUserId:function(){var e=this;!s.userId||n||r?this.initBackgroundData({code:-1}):this.models.user.checkUserId(s.userId,function(t){e.initBackgroundData(t)})},initBackgroundData:function(t){s.init({}),s.userCheckResult=t,this.models.bizInfo=e("../model/BizInfo"),this._super.apply(this,arguments)},initPage:function(){this._super.apply(this,arguments),this.views.login=e("../viewer/login/login"),this.views.login.init(this),n?this.views.login.showRegister():r||!s.userId||200==s.userCheckResult.code&&"true"==s.userCheckResult.is_set?this.views.login.showLogin():this.views.login.showRegister()},setToken:function(e){s.token=e,wizUI.util.cookie("token",e,wizUI.util.getCookieOptions())},clearToken:function(){s.token=null;var e=wizUI.util.getCookieOptions();wizUI.util.cookie("token",null),wizUI.util.cookie("CertNo",null),wizUI.util.cookie("token",null,e),wizUI.util.cookie("CertNo",null,e)},tokenInvalid:function(){this.checkUserId()}}),l=new c;t.exports={init:function(){l.wizInit()}}},{"../database/remote":8,"../database/wizCenter":9,"../model/BizInfo":11,
"../model/UserInfo":13,"../viewer/login/login":22,"./baseController":6}],8:[function(e,t,i){function o(e,t,i,r,a){if(t){if(!e||!e.url||!e.action)return void(console&&console.error("remote.sendRequest apiObj: "+e.url+"-"+e.action+" Error"));r||(r=function(){g&&g.showErrorMessage({msg:s.noteCur.editFlag?c.common.err.serverEditing:c.common.err.server,auto:-1})});var d=function(n){l=!1,"string"==typeof n?n="success"==n?{code:200}:null:wizUI.util.isArray(n)||n&&!n.code&&(n.code=n.return_code||n.err_code||n.error_code),g&&g.wizStyle()!==u.web.style.bizLogin&&g.wizStyle()!==u.web.style.bindWeibo&&e!==u.api.user.autoLogin&&n&&301==n.code?h.autoLogin(function(){t.token=s.token,o.apply(f,[e,t,i,r,a])}):i(n)},p=function(e,t,i){l=!1,"abort"!==t&&(n(e,t,i),r(e,t,i))},m=e.url,b=[];if("delete"==e.action.toLowerCase()){for(var w in t)t.hasOwnProperty(w)&&b.push(w+"="+encodeURIComponent(t[w]));b.length>0&&(m+=(m.indexOf("?")>-1?"&":"?")+b.join("&"),t={})}setTimeout(function(){$.ajax({url:m,data:t,dataType:"json",type:e.action,success:d,error:p,cache:!1})},0)}}function n(e,t,i){var o="";o=i&&"string"==typeof i?i:e&&"string"==typeof e?e:"unknown ajax error"}function r(){var e=!1;if(arguments.length>0&&"boolean"==typeof arguments[0]&&(e=arguments[0]),!e&&g&&g.wizStyle()!==u.web.style.clientComment&&!s.checkToken())return b(),null;var t,i,o,n={client_type:u.remote.CLIENT_TYPE,api_version:u.remote.API_VERSION,token:s.token},r=[n];for(t=0,i=arguments.length;i>t;t++)o=arguments[t],o&&"object"==typeof o&&r.push(o);return a.apply(f,r)}function a(){if(arguments.length<1)return{};if(arguments.length<2)return arguments[0];var e,t,i,o,n=arguments[0];for(e=1,t=arguments.length;t>e;e++){o=arguments[e];for(i in o)o.hasOwnProperty(i)&&!n[i]&&void 0!==o[i]&&(n[i]=o[i])}return n}var s=e("./wizCenter"),u=e("../../config/wizConf"),c=e("locale"),l=!1,d=null,g=null,p=!1,m=[],f=this,h={init:function(e){g=e},setAutoLogin:function(e){return e?(this.loginType=e,this):this},user:{checkUserId:function(e,t,i){var n=r(!0,{user_id:e});o(u.api.user.checkUserId,n,t,i)},login:function(e,t,i){var n=r(!0,e);o(u.api.user.login,n,t,i)},logout:function(e,t,i){var n=r(!0,e);o(u.api.user.logout,n,t,i)},register:function(e,t,i){var n=r(!0,e);o(u.api.user.register,n,t,i)},refreshToken:function(e,t){var i=r(),n=function(t){200!=t.code||e&&e(t.code)},a=function(){t&&t()};o(u.api.user.keepAlive,i,n,a)},keepAlive:function(){null===d&&(d=setInterval(function(){h.user.refreshToken()},u.remote.KEEP_ALIVE_TIME_MS))},getUserInfo:function(e,t,i){var n=r(e);o(u.api.user.userInfo,n,t,i)},changeUserId:function(e,t,i){var n=r(e);o(u.api.user.changeUserId,n,t,i)},updateUserInfo:function(e,t,i){var n=r(e);o(u.api.user.updateUserInfo,n,t,i)},changePassword:function(e,t,i){var n=r(e);o(u.api.user.changePassword,n,t,i)},resendVerifyEmail:function(e,t){o(u.api.user.resendVerifyEmail,r(),e,t)},resetPasswordApply:function(e,t,i){var n=r(!0,e);o(u.api.user.resetPasswordApply,n,t,i)},resetPassword:function(e,t,i){var n=r(!0,e);o(u.api.user.resetPassword,n,t,i)},getInviteUserList:function(e,t){o(u.api.user.getInviteUserList,r(),e,t)},payByPoint:function(e,t,i){var n=r(e);o(u.api.user.payByPoint,n,t,i)},payByCard:function(e,t,i){var n=r(e);o(u.api.user.payByCard,n,t,i)},validatePayCard:function(e,t,i){var n=r(e);o(u.api.user.validatePayCard,n,t,i)},userPay:function(e,t,i){var n=r(e);o(u.api.user.pay,n,t,i)},getPersonalPayLog:function(e,t,i){var n=r(e);o(u.api.user.getPersonalPayLog,n,t,i)},createBindOauth:function(e,t,i){var n=r(!0,e);o(u.api.user.createBindOauth,n,t,i)},oauthLogin:function(e,t,i){var n=r(!1,e);o(u.api.oauth.login,n,t,i)},oauthSignup:function(e,t,i){var n=r(!0,e);o(u.api.oauth.signup,n,t,i)},bindSNSAccount:function(e,t){var i=r(!0,e);if(!i)return void b();var o="http://"+location.host+u.api.oauth.bind[e.SNSName]+"&"+$.param(i);window.open(o),t()},unbindSNSAccount:function(e,t,i){var n=r(!0,e);o(u.api.oauth.unbind[e.SNSName],n,t,i)}},weixin:{sendSmsCaptcha:function(e,t,i){var n=r(!0,{mobile:e});o(u.api.weixin.smsCaptcha,n,t,i)},mobileLogin:function(e,t,i){var n=r(!0,{mobile:e.mobile,captcha:e.captcha,wxId:e.wxId});o(u.api.weixin.mobileLogin,n,t,i)},getWeiXinUsage:function(e,t,i){var n=r({biz_guid:e});o(u.api.weixin.getUsage,n,t,i)},increaseWeiXinUsage:function(e,t,i){var n=u.api.weixin.addUsage;n.url=n.url+"?biz_guid="+e,o(n,null,t,i)}},doc:{getAllCategory:function(e,t,i){var n=r({kb_guid:e});o(u.api.doc.getAllCategory,n,t,i)},addCategory:function(e,t,i,n){var a=r({kb_guid:e,new_name:t});o(u.api.doc.addCategory,a,i,n)},deleteCategory:function(e,t,i,n){var a=r({kb_guid:e,old_category_path:t});o(u.api.doc.deleteCategory,a,i,n)},renameCategory:function(e,t,i,n,a){var s=r({kb_guid:e,old_category_path:t,new_title:i});o(u.api.doc.renameCategory,s,n,a)},getAllTag:function(e,t,i){var n=r({kb_guid:e});o(u.api.doc.getAllTag,n,t,i)},addTag:function(e,t,i,n,a){var s=r({kb_guid:e,new_name:t,parent_tag_guid:i||""});o(u.api.doc.addTag,s,n,a)},deleteTag:function(e,t,i,n){var a=r({kb_guid:e,tag_guid:t});o(u.api.doc.deleteTag,a,i,n)},renameTag:function(e,t,i,n,a){var s=r({kb_guid:e,tag_guid:t,new_name:i});o(u.api.doc.renameTag,s,n,a)},getMessageList:function(e,t,i){var n=r(e);o(u.api.doc.getMessage,n,t,i)},setMessageStatus:function(e,t,i){var n=r({ids:e});o(u.api.doc.setMessageStatus,n,t,i)},deleteMessage:function(e,t,i){var n=r({ids:e});o(u.api.doc.deleteMessage,n,t,i)},searchDocumentList:function(e,t,i,n){var a=r({keyword:e,count:t});o(u.api.weixin.searchDocumentList,a,i,n)},getDocumentList:function(e,t,i,n){var a=r(t,{kb_guid:e});o(u.api.doc.getDocumentList,a,i,n)},getDocumentInfo:function(e,t,i,n){var a=r({kb_guid:e,document_guid:t});o(u.api.doc.getDocumentInfo,a,i,n)},getDocumentBody:function(e,t,i){var n=r(e);o(u.api.doc.getDocumentData,n,t,i)},getDocumentSummary:function(e,t,i,n){var a=r({kb_guid:e,document_guids:t,type:3});o(u.api.doc.getDocumentSummary,a,i,n)},createTempDocument:function(e,t,i){var n=r(e,{temp:!0,kb_guid:e.kb_guid});o(u.api.doc.createTmpDocument,n,t,i,null,!0)},updateDocument:function(e,t,i,n){var a=r(t,{kb_guid:e});l!==!0&&(l=!0,o(u.api.doc.updateDocument,a,i,n,null,!0))},deleteDocument:function(e,t,i,n){var a=r({kb_guid:e,document_guid:t});o(u.api.doc.deleteDocument,a,i,n)},getEditCounter:function(e,t,i){var n=r(e);o(u.api.doc.getEditCounter,n,t,i)},addEditCounter:function(e,t,i){var n=r(e);o(u.api.doc.addEditCounter,n,t,i)},deleteEditCounter:function(e,t,i){var n=r(e);o(u.api.doc.deleteEditCounter,n,t,i)},getHistory:function(e,t,i){var n=r(e);o(u.api.doc.getHistory,n,t,i)},getDeletedList:function(e,t,i){var n=r(e);o(u.api.doc.getDeletedList,n,t,i)},restoreHistory:function(e,t,i){var n=r(e);o(u.api.doc.restoreHistory,n,t,i)},recycle:function(e,t,i){var n=r(e);o(u.api.doc.recycle,n,t,i)},getAttachmentList:function(e,t,i,n){var a=r({kb_guid:e,document_guid:t});o(u.api.doc.getAttachmentList,a,i,n)},deleteAttachment:function(e,t,i,n,a){var s=r({kb_guid:e,document_guid:t,attachment_guid:i});o(u.api.doc.deleteAttachment,s,n,a)},addComment:function(e,t,i,n,a,s,c){var l={kb_guid:e,document_guid:t,comment_body:i,user_name:""};n&&a&&(l.parent_sn=n,l.parent_user_guid=a);var d=r(l);o(u.api.doc.createComment,d,s,c)},deleteComment:function(e,t,i,n){var a=r({kb_guid:e,comment_sn:t});o(u.api.doc.deleteComment,a,i,n)},getCommentList:function(e,t,i,n){var a=r({kb_guid:e,document_guid:t});o(u.api.doc.getCommentList,a,i,n)}},biz:{getBizInfo:function(e,t){var i=r();o(u.api.biz.bizInfo,i,e,t)},getBizList:function(e,t){var i=r();o(u.api.biz.getBizList,i,e,t)},createBiz:function(e,t,i){var n=r(e);o(u.api.biz.createBiz,n,t,i)},updateBiz:function(e,t,i){var n=r(e);o(u.api.biz.updateBiz,n,t,i)},finishBizGuide:function(e,t,i){var n=r(e);o(u.api.biz.finishBizGuide,n,t,i)},extendTrial:function(e,t,i){var n=r(e);o(u.api.biz.extendTrial,n,t,i)},getBizPromoteInfo:function(e,t,i){var n=r(e);o(u.api.biz.getPayPromote,n,t,i)},getPromoOrdersLog:function(e,t,i){var n=r(e);o(u.api.biz.getPromoOrdersLog,n,t,i)},getBizCouponInfo:function(e,t,i){var n=r(e);o(u.api.biz.getPayCoupon,n,t,i)},bizPay:function(e,t,i){var n=r(e);o(u.api.biz.pay,n,t,i)},getBizPayLog:function(e,t,i){var n=r(e);o(u.api.biz.getBizPayLog,n,t,i)},getBizMemberList:function(e,t,i){var n=r(e);o(u.api.biz.getBizMemberList,n,t,i)},getBizUserListForAt:function(e,t,i){var n=r(e);o(u.api.biz.getBizMemberListForAt,n,t,i)},addBizMember:function(e,t,i){var n=r(e);o(u.api.biz.addBizMember,n,t,i)},updateBizMember:function(e,t,i){var n=r(e);o(u.api.biz.updateBizMember,n,t,i)},deleteBizMember:function(e,t,i){var n=r(e);o(u.api.biz.deleteBizMember,n,t,i)}},group:{getAllGroupList:function(e,t){var i=r();o(u.api.group.getAllGroupList,i,e,t)},getBizGroupList:function(e,t,i){var n=r(e);o(u.api.group.getBizGroupList,n,t,i)},createBizGroup:function(e,t,i){var n=r(e);o(u.api.group.createBizGroup,n,t,i)},createPersonalGroup:function(e,t,i){var n=r(e);o(u.api.group.createPersonalGroup,n,t,i)},updateGroup:function(e,t,i){var n=r(e);o(u.api.group.updateGroup,n,t,i)},deleteGroup:function(e,t,i){var n=r(e);o(u.api.group.deleteGroup,n,t,i)},getGroupStorage:function(e,t,i){var n=r(e);o(u.api.group.groupStorage,n,t,i)},getGroupMemberList:function(e,t,i){var n=r(e);o(u.api.group.getGroupMemberList,n,t,i)},addGroupMember:function(e,t,i){var n=r(e);o(u.api.group.addGroupMember,n,t,i)},deleteGroupMember:function(e,t,i){var n=r(e);o(u.api.group.deleteGroupMember,n,t,i)},quitGroup:function(e,t,i){var n=r(e);o(u.api.group.quitGroup,n,t,i)},createDefaultDocument:function(e,t,i){var n=r(e);o(u.api.group.createDefaultDocument,n,t,i)},createGroupCategory:function(e,t,i){var n=r(e);o(u.api.group.createGroupCategory,n,t,i)}},share:{cancel:function(e,t,i){var n=e.shareId;delete e.shareId;var a=r(e);o({url:u.api.share.cancel.url.replace("$1",n),action:u.api.share.cancel.action},a,t,i)},create:function(e,t,i){var n=r(e);o(u.api.share.create,n,t,i)},update:function(e,t,i){var n=e.shareId;delete e.shareId;var a=r(e);o({url:u.api.share.update.url.replace("$1",n),action:u.api.share.update.action},a,t,i)},getMyShare:function(e,t,i){var n=r(e);o(u.api.share.getMyShare,n,t,i)}},weibo:{bind:function(e,t,i){o(u.api.weibo.bind,e,t,i)}},getTokenFromClient:function(e){if(!wizUI.util.getToken)return!1;var t="getToken"+(new Date).valueOf();return window[t]=function(i){i&&e({code:200,token:i}),delete window[t]},wizUI.util.getToken(t),!0},autoLogin:function(e){function t(e){if(p=!1,e&&200==e.code)for(s.setToken(e.token);m.length>0;)m.shift().call(f);else b()}function i(){p=!1,m=[],b()}var n,r={},a=this.loginType==u.web.style.wizWeixin;if(m.push(e),!p&&(p=!0,!h.getTokenFromClient(t))){if(!a){if(n=wizUI.util.cookie("CertNo"),!n)return void b();r.cookie_str=n}o(a?u.api.weixin.autoLogin:u.api.user.autoLogin,r,t,i)}}},b=function(){g&&g.tokenInvalid&&g.tokenInvalid.apply(g)};t.exports=h},{"../../config/wizConf":4,"./wizCenter":9,locale:"locale"}],9:[function(e,t,i){var o=e("../../config/wizConf"),n=e("../util/GlobalUtil"),r={token:"",userId:null,userInfo:null,isBizUser:!1,personalKb:null,shareBlackList:!1,biz:{owner:null,manageList:[],memberList:[]},bizInfo:null,groupList:[],bizMemberList:[],aliasRepeatMap:{all:1},userIdRepeatMap:{},noteFrameStatus:{sidebar:!1,fullGroup:!1,menuExpand:!1},noteCur:{kb:null,menuParams:null,docListKey:null,cmd:null,docGuid:null,docInfo:null,prevDocInfo:null,editFlag:!1,shareInfo:null},init:function(e){this.userInfo=e.user,this.personalKb=e.personalKb},setToken:function(e){r.token=e,wizUI.util.cookie("token",e,wizUI.util.getCookieOptions())},checkToken:function(){return wizUI.util.cookie("token")&&wizUI.util.cookie("token")==r.token},getUserIcon:function(e){return e=e||this.userInfo.user_guid||this.userInfo.user_id,e&&this.userInfo&&this.userInfo.icon&&e===this.userInfo.user_guid?this.userInfo.icon:o.url.user.iconBase+e+"?default=true"},checkRepeatAlias:function(e){return this.aliasRepeatMap[e]&&(this.aliasRepeatMap[e]++,e+="_0"+this.aliasRepeatMap[e]),this.appendRepeatAlias(e),e},appendRepeatAlias:function(e){this.aliasRepeatMap[e]=1},removeRepeatAlias:function(e){delete this.aliasRepeatMap[e]},setCurDocListKey:function(e){var t=e===this.noteCur.docListKey;return this.noteCur.docListKey=e,t},setCurDocInfo:function(e){window.Wiz.curDoc=e,window.Wiz.kbGuid=e?e.kb_guid:"",this.noteCur.prevDocInfo=this.noteCur.docInfo,this.noteCur.docInfo=e,this.setLastDocSave(e)},setCurShareInfo:function(e){this.noteCur.shareInfo=e},setLastDocSave:function(e){return e?(this.noteCur.docGuid=e.document_guid,void(this.noteCur.lastSaved={document_guid:e.document_guid,document_title:e.document_title,document_body:e.document_body,document_tag_guids:e.document_tag_guids,document_category:e.document_category})):(this.noteCur.lastSaved={},void(this.noteCur.editFlag=!1))},checkCurDocChanged:function(e){var t=this.noteCur.lastSaved,i=t.document_tag_guids.replace(/\*/gi,";").split(";"),o=e.document_tag_guids.split(";"),r=n.arrayCompare(i,o),a=t.document_body.replace(String.fromCharCode(65279),""),s=e.document_body.replace(String.fromCharCode(65279),"");return e.document_guid!=t.document_guid||e.document_title!=t.document_title||a!=s||r.del.length>0||r.add.length>0||e.document_category!=t.document_category}};t.exports=r},{"../../config/wizConf":4,"../util/GlobalUtil":15}],10:[function(e,t,i){function o(e,t,i,o){if(!t)return function(t,n){n&&e._controller.showErrorMessage(n),i.apply(e,[t,o])};var n=(new Date).valueOf();return u[t]=n,function(r,a){u[t]===n&&(delete u[t],a&&e._controller.showErrorMessage(a),i.apply(e,[r,o]))}}var n,r=e("../util/Class"),a=e("../../config/wizConf"),s=a.baseModel.loadingWait,u={},c=r.extend({init:function(){this._controller=n,this.doc=$("body"),this.frameEventType=a.web.frameEventType,this.dataOperateType=a.web.dataOperateType},setAttr:function(e,t){this[e]=t},getAttr:function(e){return this[e]},getBase:function(e,t,i){var n=o(this,t,i),r=this;if(this._isCacheLoading(e))return void setTimeout(function(){r.getBase.apply(r,[e,t,i])},s);var a=this._getCacheData(e);a?n(a):this._getCacheDataByRemote.apply(this,[e,n])},refresh:function(e,t,i){this._isCacheLoading(e)||this._clearCache(e),this.getBase.apply(this,arguments)},_getCallback:function(e,t,i){return o(this,e,t,i)},_getKey:function(e){},_isCacheLoading:function(e){},_getCacheData:function(e){},_getCacheDataByRemote:function(e,t){},_clearCache:function(e){}});c.setController=function(e){n=e},t.exports=c},{"../../config/wizConf":4,"../util/Class":14}],11:[function(e,t,i){var o=e("./CacheModel"),n=e("./BaseModel"),r=e("../database/remote"),a=e("../database/wizCenter"),s=e("../../config/wizConf"),u=e("../util/GlobalUtil"),c=e("locale"),l=o.extend({getBizInfo:function(){return this.map.bizInfo},setBizInfo:function(e){this.map.bizInfo=e},getBizList:function(){return this.map.bizList},setBizList:function(e){this.map.bizList=e},createBizMemberList:function(){this.map.bizMemberList||(this.map.bizMemberList={}),this.map.bizMemberList[a.bizInfo.biz_guid]||(this.map.bizMemberList[a.bizInfo.biz_guid]=[])},getBizMemberList:function(){return this.map.bizMemberList?this.map.bizMemberList[a.bizInfo.biz_guid]:null},getBizMember:function(e,t){if(!this.map.bizMemberList)return null;var i,o,n=this.map.bizMemberList[a.bizInfo.biz_guid];for(i=n.length-1;i>=0;i--)if(o=n[i],o[e]===t)return o;return null},getBizMembers:function(e,t){if(!this.map.bizMemberList)return[];var i,o,n=this.map.bizMemberList[a.bizInfo.biz_guid],r=[];for(i=n.length-1;i>=0;i--)o=n[i],o[e]===t&&r.push(o);return r},setBizMemberList:function(e){this.createBizMemberList();var t,i;for(t=e.length-1;t>=0;t--)i=e[t],i.user_id=i.user_id.toLowerCase(),i.avatar=a.getUserIcon(i.user_guid||i.user_id);this.map.bizMemberList[a.bizInfo.biz_guid]=e,this.sortBizMemberList()},sortBizMemberList:function(){var e=this.getBizMemberList();e.sort(function(e,t){return e.user_group===s.web.authority.biz.owner?-1:t.user_group===s.web.authority.biz.owner?1:e.user_group===s.web.authority.biz.admin&&t.user_group>s.web.authority.biz.admin?-1:t.user_group===s.web.authority.biz.admin&&e.user_group>s.web.authority.biz.admin?1:e.alias.localeCompare(t.alias)})},addBizMember:function(e){if(!e)return null;this.createBizMemberList();var t,i,o,n=[];for(t=e.length-1;t>=0;t--)o=e[t],200!=o.status_code&&e.splice(t,1);var r=this.getBizMemberList(),s={};if(r)for(t=0,i=r.length;i>t;t++)s[r[t].user_id]=!0;for(t=0,i=e.length;i>t;t++)o=e[t],s[o.user_id]||(o.avatar=a.getUserIcon(o.user_guid||o.user_id),this.map.bizMemberList[a.bizInfo.biz_guid].push(o),n.push(o));return this.sortBizMemberList(),n},updateBizMember:function(e){var t,i,o=this.getBizMemberList();for(t=o.length-1;t>=0;t--)if(i=o[t],i.user_guid==e.user_guid)return"undefined"!=typeof e.user_group&&(i.user_group=e.user_group),i.alias=e.alias,i.avatar=a.getUserIcon(i.user_guid||i.user_id),p._controller.models.groupInfo.updateMemberAlias(i.user_id,i.alias),void this.sortBizMemberList()},deleteBizMember:function(e){if(e){var t,i,o,n={};for(t=e.length-1;t>=0;t--)i=e[t],200==i.status_code&&(n[i.user_guid]=!0,o=this.getBizMember("user_guid",i.user_guid),o&&p._controller.models.groupInfo.deleteGroupMemberFromBiz(o.user_id));for(e=this.getBizMemberList(),t=e.length-1;t>=0;t--)i=e[t],n[i.user_guid]&&e.splice(t,1)}}}),d=new l,g=n.extend({_getKey:function(){return a.token},_isCacheLoading:function(){return d.isLoading(this._getKey())},_getCacheData:function(){return d.getBizInfo()},_getCacheDataByRemote:function(e,t){var i=this._getKey();d.setLoading(i,!0),r.biz.getBizInfo(function(e){return d.setLoading(i,!1),e?(200==e.code&&d.setBizInfo(e),void t(e)):void t(null)})},_clearCache:function(){d.clearCache(this._getKey())},extendTrial:function(e,t){var i="";e.extend_note=JSON.stringify(e.extend_note),r.biz.extendTrial(e,function(e){e&&200==e.code?(p._controller.showSuccessMessage({msg:c.bizExtendTrial.suc,auto:-1}),t(e)):(i=e&&321==e.code?c.bizExtendTrial.err[321]:e&&3213==e.code?c.bizExtendTrial.err[3213]:c.bizExtendTrial.err.fail,p._controller.showErrorMessage({msg:i}),t())})},createBiz:function(e,t){r.biz.createBiz(e,function(e){e&&200==e.code?t(e):(t(),p._controller.showErrorMessage({msg:c.bizGuide.err.createBiz}))})},updateBiz:function(e,t){r.biz.updateBiz(e,function(e){e&&200==e.code?(t&&t(e),p.doc.trigger(p.frameEventType.EventManager,[p.dataOperateType.OnUpdateBizInfo,e]),p._controller.showSuccessMessage({msg:c.bizInfo.suc.save})):(t&&t(),p._controller.showErrorMessage({msg:c.bizInfo.err.save}))})},getBizList:function(e){var t=d.getBizList();return t?void e(t):void r.biz.getBizList(function(t){t&&200==t.code?(d.setBizList(t.result),e(d.getBizList())):e()})},getBizByGuid:function(e){var t=d.getBizList();if(!t||0===t.length)return null;var i,o,n;for(i=0,o=t.length;o>i;i++)if(n=t[i],n.biz_guid==e)return n;return null},checkNewBizMemberList:function(e){for(var t,i,o={},n=e.length,r=[],a=[],s=[],c=[],l=0;n>l;l++)if(t=e[l].toLowerCase(),u.userIdNeedVerify(t))s.push(t);else if(u.verifyEmail(t)||u.verifyMobile(t)){if(u.verifyMyWizEmail(t)){c.push(t);continue}i=p.getBizMember("email",t)||p.getBizMember("mobile",t),i?a.push(t):o[t]||(s.push(t),o[t]=1)}else{if(""===$.trim(t))continue;r.push(t)}return{good:s,bad:r,exist:a,mywiz:c}},addBizMember:function(e,t,i){if(!p._controller.checkBizExpired(a.bizInfo))return void(t&&t(!1));var o,n,l=e.users;for(o=l.length-1;o>=0;o--)n=l[o],n.user_id=n.user_id.toLowerCase();e.users=JSON.stringify(e.users),r.biz.addBizMember(e,function(e){if(e&&200==e.code){var o,n,r,g=e.result,m={};for(o=l.length-1;o>=0;o--)n=l[o],m[n.user_id]=n;for(o=g.length-1;o>=0;o--)n=g[o],200!=n.status_code?g.splice(o,1):(r=m[n.user_id],n.alias=r.alias,n.user_group=r.user_group,u.verifyEmail(n.user_id)?n.email=n.user_id:n.mobile=n.user_id);g=d.addBizMember(g),t&&t(g),i||p._controller.showSuccessMessage({msg:c.bizMember.suc.addMember.replace("$1",g.length)}),p.doc.trigger(p.frameEventType.EventManager,[p.dataOperateType.OnAddBizMember,g])}else e&&327==e.code&&p._controller.showErrorMessage({msg:c.bizMember.err.memberFull.replace("$1",s.web.memberMaxCount.biz[a.bizInfo.biz_level])}),t&&t()})},updateBizMember:function(e,t){if(!p._controller.checkBizExpired(a.bizInfo))return void(t&&t(!1));var i=e.biz_user;e.biz_user=JSON.stringify(e.biz_user),r.biz.updateBizMember(e,function(e){e&&200==e.code?(d.updateBizMember(i),t&&t(e),p._controller.showSuccessMessage({msg:c.bizMember.suc.updateMember})):(t&&t(),p._controller.showErrorMessage({msg:c.bizMember.err.updateMember}))})},deleteBizMember:function(e,t){return p._controller.checkBizExpired(a.bizInfo)?(e.users=JSON.stringify(e.users),void r.biz.deleteBizMember(e,function(e){e&&200==e.code?(d.deleteBizMember(e.result),t(e),p._controller.showSuccessMessage({msg:c.bizMember.suc.deleteMember}),p.doc.trigger(p.frameEventType.EventManager,[p.dataOperateType.OnUpdateGroupMember,""])):(t(),p._controller.showErrorMessage({msg:c.bizMember.err.deleteMember}))})):void t(!1)},getBizMemberList:function(e,t){var i=d.getBizMemberList();return i?void t(i):void r.biz.getBizMemberList(e,function(e){e&&200==e.code?(i=e.users||[],d.setBizMemberList(i),t(d.getBizMemberList())):t([])})},getBizOwner:function(){return d.getBizMember("user_group",s.web.authority.biz.owner)},getBizManagers:function(){return d.getBizMembers("user_group",s.web.authority.biz.admin)},getBizMember:function(e,t){return d.getBizMember(e,t)},isOwner:function(e){var t=this.getBizOwner();return t&&t.user_id===e},isManager:function(e){var t,i,o,n=this.getBizManagers();for(t=0,i=n.length;i>t;t++)if(o=n[t],o.user_id===e)return!0;return!1},isDefaultGroupManager:function(e){return this.isOwner(e)||this.isManager(e)},finishBizGuide:function(e,t){r.biz.finishBizGuide(e,function(e){e&&200==e.code?t(e):t()})},getBizPromoteInfo:function(e,t){r.biz.getBizPromoteInfo(e,function(e){e&&200==e.code?t(e):e?t({code:e.code}):t()})},getPromoOrdersLog:function(e,t){r.biz.getPromoOrdersLog(e,function(e){t(e)})},getBizCouponInfo:function(e,t){var i=e.biz_guid;r.biz.getBizCouponInfo(e,function(e){var o=new Date;if(e&&200==e.code){if(+o>e.dtDue)return void t({code:3464});if(e.batch_used)return void t({code:3467});var n=e.result.status,r=e.result.ownerGuid;0===n?p._controller.showSuccessMessage({msg:c.bizPay.label.addCouponSuccess}):1==n?e.code=3463:2===n?r===i?p._controller.showSuccessMessage({msg:c.bizPay.label.addCouponSuccess}):e.code=3465:e=null,t(e)}else e?t(e):(t(),p._controller.showErrorMessage({msg:c.bizPay.label.addCouponFail}))})},getBizPayLog:function(e,t){r.biz.getBizPayLog(e,function(e){200===e.code&&t(e.result)})},getBizPayLink:function(){return wizUI.util.setUrlParams(s.url.biz.pay,{level:a.bizInfo.biz_level+1,biz:a.bizInfo.biz_guid,token:a.token})},bizPay:function(e,t){r.biz.bizPay(e,function(e){t(e)})}}),p=new g;t.exports=p},{"../../config/wizConf":4,"../database/remote":8,"../database/wizCenter":9,"../util/GlobalUtil":15,"./BaseModel":10,"./CacheModel":12,locale:"locale"}],12:[function(e,t,i){var o=e("../util/Class"),n=e("../util/GlobalUtil"),r=e("../../config/wizConf"),a=o.extend({init:function(e){this.map={},this.list={},this.loadingMap={},this.localStorageTimeout=e&&e.localStorageTimeout?e.localStorageTimeout:r.baseModel.localStorageTimeout},isLoading:function(e){return this.loadingMap[e]},setLoading:function(e,t){t?this.loadingMap[e]=!0:delete this.loadingMap[e]},saveLocalStorage:function(e,t){window.localStorage&&window.localStorage.setItem(e,n.encode(JSON.stringify({time:(new Date).valueOf(),data:t})))},deleteLocalStorage:function(e){window.localStorage&&window.localStorage.removeItem(e)},loadLocalStorage:function(e){var t,i,o,r;return window.localStorage&&(t=window.localStorage[e])?(i=JSON.parse(0===t.indexOf("{")?t:n.decode(t)),o=i.time,r=(new Date).valueOf(),r-o<this.localStorageTimeout?i.data:(window.localStorage.removeItem(e),null)):null},clearCache:function(e){delete this.list[e],delete this.map[e]}});t.exports=a},{"../../config/wizConf":4,"../util/Class":14,"../util/GlobalUtil":15}],13:[function(e,t,i){var o=e("./CacheModel"),n=e("./BaseModel"),r=e("../database/remote"),a=e("../database/wizCenter"),s=e("../../config/wizConf"),u=e("locale"),c=o.extend({init:function(){this._super.apply(this,arguments)},getUserInfo:function(){return this.map.user},setUserInfo:function(e){function t(e){var t;for(t in s.web.pointType)if(s.web.pointType.hasOwnProperty(t)&&0===e.indexOf(t))return s.web.pointType[t];return null}e.email_verified="true"===e.email_verified,e.onlyOauth=e.email&&0===e.email.indexOf("#"),e.icon=a.getUserIcon(e.user_guid||e.user_id)+"&_"+(new Date).valueOf(),this.map.user=e;var i,o,n,r;if(e.point_logs)for(i=0,o=e.point_logs.length;o>i;i++)n=e.point_logs[i],r=t(n.logCode),r&&(n.logMsg=u.accountSetting.pointType[r].replace("$1",n.logLong))},getUserBizInfo:function(){return this.map.biz},setUserBizInfo:function(e){this.map.biz=e}}),l=new c,d=s.remote.GET_USER_INFO_RETRY,g=n.extend({_getKey:function(e){return e.token},_isCacheLoading:function(e){return l.isLoading(this._getKey(e))},_getCacheData:function(){return l.getUserInfo()},_getCacheDataByRemote:function(e,t){var i=this._getKey(e);d--,l.setLoading(i,!0),r.user.getUserInfo(e,function(o){return l.setLoading(i,!1),o&&o.code&&"200"==o.code?o?(l.setUserInfo(o),void t(o)):void t(null):void(d>0&&o&&301!=o.code?p._getCacheDataByRemote(e,t):t(null))})},_clearCache:function(e){l.clearCache(this._getKey(e))},keepAlive:function(){r.user.keepAlive()},login:function(e,t){r.user.login(e,function(e){e&&e.code?t(e):t()})},logout:function(e,t){r.user.logout(e,function(){t()})},loginByCertNo:function(e){r.autoLogin(e)},register:function(e,t){var i=wizUI.util.getUrlParam("product_type");i&&(e.product_type=i);var o=wizUI.util.cookie("signup_source");o&&(e.signup_source=o),r.user.register(e,function(e){e&&e.code?t(e):t()})},checkUserId:function(e,t){r.user.checkUserId(e,t)},changeUserId:function(e,t){r.user.changeUserId(e,function(e){if(e&&200==e.code)return p._controller.showSuccessMessage({msg:u.accountSetting.suc.changeUserId}),void t(e);var i=u.accountSetting.err.changeUserId;e&&(31002==e.code?i=u.accountSetting.err.changeUserIdPwd:31e3==e.code&&(i=u.common.err[e.code])),p._controller.showErrorMessage({msg:i}),t()})},createBindOauth:function(e,t){r.user.createBindOauth(e,function(e){var i=u.accountSetting.suc.createBind;e&&200==e.code?(t(e),p._controller.showSuccessMessage({msg:i})):(t(),i=u.accountSetting.err.createBind,e&&31e3==e.code&&(i=u.accountSetting.err.hasBind),p._controller.showErrorMessage({msg:i}))})},updateUserInfo:function(e,t){r.user.updateUserInfo(e,function(i){var o=/[@#]/,n=u.accountSetting.suc.changeUserInfo;return i&&200==i.code?("mobile"==e.key&&o.test(a.userInfo.user_id)&&(n=u.accountSetting.suc.changeUserId),p._controller.showSuccessMessage({msg:n}),void t(i)):(n=u.accountSetting.err.changeUserInfo,p._controller.showErrorMessage({msg:n}),void t())})},changePassword:function(e,t){r.user.changePassword(e,function(e){e&&200==e.code?(p._controller.showSuccessMessage({msg:wizUI.isWizClient?u.accountSetting.suc.changePassword_client:u.accountSetting.suc.changePassword_web,auto:-1}),t(e)):(p._controller.showErrorMessage({msg:u.accountSetting.err.changePassword,auto:5e3}),t())})},resendVerifyEmail:function(e){r.user.resendVerifyEmail(function(t){t&&200==t.code?(p._controller.showSuccessMessage({msg:u.accountSetting.emailVerify.success}),e(t)):(p._controller.showErrorMessage({msg:u.accountSetting.emailVerify.fail}),e())})},getInviteUserList:function(e){r.user.getInviteUserList(function(t){t&&200==t.code?e(t):e()})},userPay:function(e,t){r.user.userPay(e,function(e){e&&200==e.code?t(e):e?(p._controller.showErrorMessage({msg:u.common.err[e.code]}),t()):t()})},payByPoint:function(e,t){r.user.payByPoint(e,function(e){e&&200==e.code?(t(e),p._controller.showSuccessMessage({msg:u.personalVipTable.pointExchange.success})):(t(),p._controller.showErrorMessage({msg:u.personalVipTable.pointExchange.fail}))})},payByCard:function(e,t){r.user.payByCard(e,function(e){e&&200==e.code?(t(e),p._controller.showSuccessMessage({msg:u.personalVipTable.card.success})):(t(),p._controller.showErrorMessage({msg:u.personalVipTable.card.fail}))})},validatePayCard:function(e,t){r.user.validatePayCard(e,function(e){e&&200==e.code?(t(e),p._controller.showSuccessMessage({msg:u.personalVipTable.card.verifySuc})):(t(),p._controller.showErrorMessage({msg:u.personalVipTable.card.fail}))})},getPersonalPayLog:function(e){r.user.getPersonalPayLog({charge_state:200},function(t){t&&200==t.code?e(t):e()})},bindSNS:function(e,t){r.user.bindSNSAccount(e,t)},unbindSNS:function(e,t){r.user.unbindSNSAccount(e,function(e){e&&200==e.code?t(e):t()})},oauthLogin:function(e,t){r.user.oauthLogin(e,function(e){t(e)})},oauthBind:function(e,t){e.type=1,r.user.oauthSignup(e,function(e){t(e)})},oauthCreate:function(e,t){e.type=2,r.user.oauthSignup(e,function(e){t(e)})},oauthAutoCreate:function(e,t){e.type=3,r.user.oauthSignup(e,function(e){t(e)})},resetPasswordApply:function(e,t){var i=!!e.noSucMsg;delete e.noSucMsg,r.user.resetPasswordApply(e,function(o){if(o&&"200"==o.code)return t(o),void(i||p._controller.showSuccessMessage({msg:u.resetPwd.suc.apply.replace("$1",e.email),auto:-1}));var n=u.resetPwd.err.apply;o&&"366"==o.code?n=u.common.err.checkCode:o&&"31004"==o.code&&(n=u.common.err[o.code]),p._controller.showErrorMessage({msg:n}),t()})},resetPassword:function(e,t){var i="";r.user.resetPassword(e,function(e){if(e){if("200"==e.code)return p._controller.showSuccessMessage({msg:u.resetPwd.suc.common.replace("$1",'<a href="'+s.url.common.login+'">'+u.common.label.login+"</a>")}),void t(e);i="31004"==e.code?u.common.err[e.code]:u.resetPwd.err.linkFailure,p._controller.showErrorMessage({msg:i}),t(e)}else p.controller.showErrorMessage({msg:u.common.err.server}),t()})},sendSmsCaptcha:function(e,t){r.weixin.sendSmsCaptcha(e,function(e){t(e)})},mobileLogin:function(e,t){r.weixin.mobileLogin(e,function(e){t(e)})},bindWeiboFans:function(e,t){e.state=wizUI.util.getUrlParam("state")||"",r.weibo.bind(e,function(e){t(e)})}}),p=new g;t.exports=p},{"../../config/wizConf":4,"../database/remote":8,"../database/wizCenter":9,"./BaseModel":10,"./CacheModel":12,locale:"locale"}],14:[function(e,t,i){function o(e){function t(){!n&&this.init&&this.init.apply(this,arguments)}var i=this.prototype;n=!0;var a=new this;n=!1;for(var s in e)a[s]="function"==typeof e[s]&&"function"==typeof i[s]&&r.test(e[s])?function(e,t){return function(){var o=this._super;this._super=i[e];var n=t.apply(this,arguments);return this._super=o,n}}(s,e[s]):e[s];return t.prototype=a,t.prototype.constructor=t,t.extend=o,t}var n=!1,r=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/,a=function(){};a.extend=o,t.exports=a},{}],15:[function(e,t,i){var o=e("../../config/wizConf"),n={aliasReplaceReg:/[^\.a-zA-Z0-9\u4e00-\u9fa5_]/g,aliasTestReg:/^[\.a-zA-Z0-9\u4e00-\u9fa5_]+$/,userIdSpliter:/[\s,;，；　]/,replaceScriptTagReg:/<[\/]?script[^<>]*[\/]?>/gi,couponSN:/^[a-zA-Z0-9\-]{6,64}$/,promoteSN:/PR[a-zA-Z0-9]{8}/,verifyEmpty:function(e){return!!e},userIdNeedVerify:function(e){return _WIZ_CONFIG.oem.getData("NotVerifyUserIdForAddMember")?!!e:!1},verifyEmail:function(e){var t=/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/;return t.test(e)},verifyMobile:function(e){var t=/^1[\d]{10}$/;return t.test(e)},verifyMyWizEmail:function(e){var t=/^\w+([-+.]\w+)*@mywiz\.cn$/;return t.test(e)},verifyWizEmail:function(e){var t=6,i=18,o=e.length;return""===e?!1:t>o?!1:/^\w[\w\-\.]*\w$/.test(e)?o>i?!1:!0:!1},verifyDiscoutSN:function(e){return n.isCouponSN(e)||n.isPromoteSN(e)},verifyMarkdown:function(e){return e?-1!=e.indexOf(".md ")?!0:-1!=e.indexOf(".md@")?!0:!!e.match(/\.md$/i):!1},getAlias:function(e){if(n.verifyEmail(e))return e.replace(/(.+)@.+/,"$1").replace(n.aliasReplaceReg,"");if(n.verifyMobile(e)){var t=new RegExp("(\\d{3})(\\d*)(\\d{4})");return e.replace(t,"$1....$3")}return e},checkValidBizName:function(e){var t=$.trim(e);return t.length>=2},checkValidBizTel:function(e){return e.length>5},checkValidAlias:function(e){e=$.trim(e);var t=n.aliasTestReg;return t.test(e)?"all"!==e:!1},checkValidPasswd:function(e,t,i){var o=t||6,r=i||100,a=$.trim(e);

if(""===a)return!1;var s=n.isGoodPassword(a,o,r);if(s===!1)return!1;var u,c=!0;for(u=0;u<a.length;u++)a.charCodeAt(u)>255&&(c=!1);return!c||a.length<o?!1:a.length<=r},isValidGroupName:function(e){var t=$.trim(e);return t.length<2||t.length>30?!1:/^[\-\. a-zA-Z0-9_\u4e00-\u9fa5]+$/.test(t)?!n.isConSpeCharacters(t):!1},isValidGroupNote:function(e){return!0},isContainHtmlTag:function(e){var t=e.match(/[<>]/gi);return!t},isCouponSN:function(e){return n.couponSN.test(e)},isPromoteSN:function(e){return n.promoteSN.test(e)},getHost:function(e){var t=location.host;return/\.[0-9]$/.test(t),/\.[0-9]$/.test(t)===!1&&(t=e+".wiz.cn"),t},isGoodPassword:function(e,t,i){var o=t||6,n=i||16;return""===e||e.length<o||e.length>n?!1:!0},changeClass:function(e,t){$("#"+e).removeClass().addClass(t)},isWinPlatform:function(){var e=window.navigator.platform,t=0===e.toLowerCase().indexOf("mac"),i=0===e.toLowerCase().indexOf("linux");return!(t||i)},isIe:function(){return!!document.all},isConSpeCharacters:function(e){if(!e)return!1;var t=/[\\\/\*\?&:<>"']/gi;return!!e.match(t)},genGuid:function(){function e(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},lastIndexOfArray:function(e,t){if(Array.prototype.lastIndexOf)return Array.prototype.lastIndexOf.call(e,t);var i=e.length,o=i-1;for(0>o&&(o=Math.max(0,i+o));o>=0;o--)if(o in e&&e[o]===t)return o;return-1},getUtcTime:function(){var e=new Date,t=e.getTime(),i=6e4*e.getTimezoneOffset();return new Date(t+i)},getCurTime:function(){var e=new Date,t=e.getHours(),i=e.getMinutes(),o="";return o=10>i?t+":0"+i:t+":"+i},getFrameDocument:function(e){return e.contentDocument?e.contentDocument:e.contentWindow.document},addParamsToUrl:function(e,t){function i(e){var t="";for(var i in e)!e.hasOwnProperty(i)||"string"!=typeof e[i]&&"number"!=typeof e[i]||(t=t+"&"+i+"="+encodeURIComponent(e[i]));return t=t.substr(1)}if("string"==typeof e){var o=i(t),n="&";-1===e.indexOf("?")&&(n="?"),e=e+n+o}return e},getPageScroll:function(){var e={};return"undefined"!=typeof window.pageYOffset?(e.left=window.pageXOffset,e.top=window.pageYOffset):"undefined"!=typeof document.compatMode&&"BackCompat"!=document.compatMode?(e.left=document.documentElement.scrollLeft,e.top=document.documentElement.scrollTop):"undefined"!=typeof document.body&&(e.left=document.body.scrollLeft,e.top=document.body.scrollTop),e},getMousePoint:function(e){var t={},i=n.getPageScroll();return t.x=i.left+e.clientX,t.y=i.top+e.clientY,t},formatISODateString:function(e){return e?e.replace("T"," ").replace(/:\d+.\d+Z/,""):""},modifyTreeNodeDom:function(e,t){var i=parseInt($("#"+e).attr("indentLevel"),10),n=t.level,r=t.tId;i=isNaN(i)?1:i;var a=$("#"+r+"_switch"),s=$("#"+r+"_check"),u=$("#"+r+"_ico");if(u.before(a),s.get(0)&&a.after(s),n>=i){var c,l;for(c=0,l=n-i;l>=c;c++)a.before('<span class="tmpIndent"></span>')}var d=$.fn.zTree.getZTreeObj(e).setting.treeObj;o.web.note.menuCmd&&t.cmd===o.web.note.menuCmd.create&&($("#"+t.tId+"_a",d).addClass("create-link"),$("#"+t.tId+"_ico",d).addClass("icon-b"))},sortObjArr:function(e,t,i,o){"asc"===o?e.sort(function(e,o){switch(i){case"number":return e[t]-o[t];case"date":return Number(e[t]>o[t])-.5;case"string":return e[t]&&e[t].localeCompare(o[t])}return 0}):"desc"===o&&e.sort(function(e,o){switch(i){case"number":return o[t]-e[t];case"date":return Number(o[t]>e[t])-.5;case"string":return o[t]&&o[t].localeCompare(e[t])}return 0})},arrayCompare:function(e,t,i,o){function n(e,t){return"string"==typeof e?e:e[t]}function r(e,t,i){if(!i||0===i.length)return!0;for(var o=i.length,n=0;o>n;n++)if(e[i[n]]!==t[i[n]])return!1;return!0}if(!e||!t)return null;var a,s,u,c,l,d=e.length,g=t.length,p=[],m=[],f=[],h=[],b={},w={};for(a=0;g>a;a++)s=n(t[a],i),b[s]=a;for(a=0;d>a;a++)s=n(e[a],i),c=b[s],u="undefined"==typeof c?null:t[c],w[s]=a,"undefined"==typeof u||null===u?h.push(a):r(u,e[a],o)?m.push(a):f.push(a);for(a=0;g>a;a++)s=n(t[a],i),l=w[s],"undefined"==typeof l&&p.push(a);return{add:p,del:h,keep:m,update:f}},getDomPosition:function(e){if(!e)return null;var t=e.offset(),i=parseInt(e.css("height"),10),o=parseInt(e.css("width"),10);return{top:t.top,left:t.left,height:i,width:o}},setLayout:function(e,t,i,r,a){var s,u,c,l,d=n.getDomPosition(e),g=n.getDomPosition(t),p=n.getPageScroll(),m=$(window).width(),f=$(window).height(),h="50%",b="30%",w=0,z=-d.width/2;r?(s=0,u=m,c=0,l=f):(s=0+p.left,u=m+p.left,c=0+p.top,l=f+p.top),g&&i&&(w=0,z=0,i==o.web.confirm.Type.UpLeft||i==o.web.confirm.Type.UpRight?b=g.top-d.height-(a?0:o.web.confirm.Space):i==o.web.confirm.Type.DownLeft||i==o.web.confirm.Type.DownRight?b=g.top+g.height+(a?0:o.web.confirm.Space):i==o.web.confirm.Type.LeftUp||i==o.web.confirm.Type.LeftDown?h=g.left-d.width-(a?0:o.web.confirm.Space):(i==o.web.confirm.Type.RightUp||i==o.web.confirm.Type.RightDown)&&(h=g.left+g.width+(a?0:o.web.confirm.Space)),i==o.web.confirm.Type.UpLeft||i==o.web.confirm.Type.DownLeft?(h=g.left,r&&(h-=p.left),h+d.width>u&&(h=u-d.width)):i==o.web.confirm.Type.UpRight||i==o.web.confirm.Type.DownRight?(h=g.left+g.width-d.width,r&&(h-=p.left),s>h&&(h=s)):i==o.web.confirm.Type.LeftUp||i==o.web.confirm.Type.RightUp?(b=g.top,r&&(b-=p.top),b+d.height>l&&(b=l-d.height)):(i==o.web.confirm.Type.LeftDown||i==o.web.confirm.Type.RightDown)&&(b=g.top+g.height-d.height,r&&(b-=p.top),c>b&&(b=c))),e.css({left:h,top:b,"margin-top":w+"px","margin-left":z+"px"})},renderLanguage:function(e){function t(e,t){if(!t||0===t[0].length||!e[t[0]])return null;for(var i=e;t.length>0&&(i=i[t.shift()],"undefined"!=typeof i);)if("string"==typeof i)return i;return null}var i,o,n,r,a=$("[data-lang]"),s=a.length;for(r=0;s>r;r++)i=a.eq(r),o=i.attr("data-lang").split("."),n=t(e,o),n&&i.html(n);for(a=$("[data-title-lang]"),s=a.length,r=0;s>r;r++)i=a.eq(r),o=i.attr("data-title-lang").split("."),n=t(e,o),n&&i.attr("title",n);var u=$("[data-placeholder]"),c=u.length;for(r=0;c>r;r++)i=u.eq(r),o=i.attr("data-placeholder").split("."),n=t(e,o),n&&i.attr("placeholder",n);var l=$("[data-alt-lang]");for(r=0;r<l.length;r++)i=l.eq(r),o=i.attr("data-alt-lang").split("."),n=t(e,o),n&&i.attr("alt",n)},setSelection:function(e,t,i){function o(e,t,i){if(e.setSelectionRange)e.focus(),e.setSelectionRange(t,i);else if(e.createTextRange){var o=e.createTextRange();o.collapse(!0),o.moveEnd("character",i),o.moveStart("character",t),o.select()}}o(e,t,i)},getDeleteMembersName:function(e,t,i){var o,n=i?t.bizMember.label.confirmDeleteMember:t.groupMember.label.confirmDeleteMember,r=i?t.bizMember.label.confirmDeleteMembers:t.groupMember.label.confirmDeleteMembers;return 1==e.length?o=n.replace("$1",e[0]):(o=r.replace("$1",e.length),e.length>5?(e=e.splice(0,5),o=o.replace("$2",e.join(", ")+"...")):o=o.replace("$2",e.join(", "))),o},encode:function(e){var t,i=[];for(t=0;t<e.length;t++)i.push((2*e.charCodeAt(t)+23).toString(8));return i.join("%")},decode:function(e){var t,i=[],o=e.split("%");for(t=0;t<o.length;t++)i.push(String.fromCharCode((parseInt(o[t],8)-23)/2));return i.join("")},getExtendTrialHtml:function(e,t){return'<a href="javascript:void(0);" class="wizExtendTrial" data-url="'+o.url.biz.extendTrial+"?biz="+e.biz_guid+'">'+t.bizInfo.label.extension+"</a>"},htmlUnEncode:function(e){return String(e).replace(/&amp;/g,"&").replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&&#39;/g,"'")},parseHTMLStr:function(e){var t={head:"",body:""},i=/<head[^>]*>([\s\S]*)<\/head>([^<]*)<body[^>]*>([\s\S]*)<\/body>/m;if(i.test(e)){var o=e.match(i);t.head=o[1],t.body=o[3]}else t.body=e;return t},parseWizLink:function(e,t){var i=e.replace(/^[^\?]*/i,""),n=wizUI.util.getUrlParam("kbguid",i),r=wizUI.util.getUrlParam("guid",i);n||(n=wizUI.util.getUrlParam("private_kbguid",i));var a=/wiz:(\/\/)?open_document/i,s=/wiz:(\/\/)?open_attachment/i;return a.test(e)?(t?o.url.common.noteFullScreenForMobile:o.url.common.noteFullScreen)+"?kb="+n+"&dc="+r:(s.test(e),"")},setIframeContent:function(e,t){var i=this.getFrameDocument(t),o=e.indexOf("<");if(0!==o&&(e=e.slice(o)),"string"==typeof e){i.open("text/html","replace");var n=e.match(/<html[^<>]*>([\s\S]*)<\/html>/im);i.write(n&&n.length?n[0]:e),i.close()}},getCaptchaCodeId:function(){return(+new Date).toString().slice(-8)+Math.random().toString(36).substr(2,6)},xssFilter:function(){if("undefined"==typeof window.filterXSS)return null;var e=new window.filterXSS.FilterXSS({safeAttrValue:function(e,t,i){return"a"===e&&"href"===t&&"wiz://"===i.substr(0,6)?window.filterXSS.escapeAttrValue(i):window.filterXSS.safeAttrValue(e,t,i)}});return function(t){return e.process(t)}}()};t.exports=n},{"../../config/wizConf":4}],16:[function(e,t,i){function o(e,t){return e?(c[e]||(c[e]={}),c[e][t]||(c[e][t]={list:[],func:null}),c[e][t].list):null}function n(e,t){for(var i=0,o=e.length;o>i;i++)if(e[i]===t)return i;return-1}function r(e,t){e&&!c[e][t].func&&(c[e][t].func=function(){for(var i=c[e][t].list,o=0,n=i.length;n>o;o++)i[o].apply(this,arguments)},$(e).bind(t,c[e][t].func))}function a(e,t){e&&c[e][t].func&&($(e).unbind(t,c[e][t].func),delete c[e][t])}function s(e,t,i){if(wizUI.util.isFunction(i)){e.jquery&&(e=e.get(0));var a=o(e,t);n(a,i)>=0||(a.push(i),r(e,t))}}function u(e,t,i){if(wizUI.util.isFunction(i)){e.jquery&&(e=e.get(0));var r=o(e,t),s=n(r,i);s>=0&&r.splice(s,1),0===r.length&&a(e,t)}}var c={},l={bind:function(e,t,i){var o,n;if(wizUI.util.isArray(i))for(o=0,n=i.length;n>o;o++)s(e,t,i[o]);else s(e,t,i)},unbind:function(e,t,i){var o,n;if(wizUI.util.isArray(i))for(o=0,n=i.length;n>o;o++)u(e,t,i[o]);else u(e,t,i)}};t.exports=l},{}],17:[function(e,t,i){function o(){for(var e=0,t=a.length;t>e;e++)a[e].apply(u);s=t>0?setTimeout(function(){o()},r.web.globalTimer):null}function n(e){for(var t=0,i=a.length;i>t;t++)if(a[t]===e)return!0;return!1}var r=e("../../config/wizConf"),a=[],s=null,u=this,c={add:function(e){wizUI.util.isFunction(e)&&!n(e)&&a.push(e),!s&&a.length>0&&o()},remove:function(e){for(var t=a.length-1;t>=0;t--)if(a[t]==e){a.splice(t,1);break}}};t.exports=c},{"../../config/wizConf":4}],18:[function(e,t,i){function o(e,t){for(var i=e.length,o=0,r=0;i>r;r++){var a,s=e[r].validate,u=e[r].vTar,c=u.parents(".form-control");u.val()?s(u.val())?(o++,n(c,0),a=void 0):a=-2:a=t?void 0:-1,n(c,a)}return o===i}function n(e,t){var i=null;1===t?(e.removeClass(r.format),e.removeClass(r.empty),e.removeClass(r.custom),e.addClass(r.success)):-1===t?(e.removeClass(r.success),e.removeClass(r.format),e.removeClass(r.custom),e.addClass(r.empty),i=$("."+r.empty,e)):-2===t?(e.removeClass(r.success),e.removeClass(r.empty),e.removeClass(r.custom),e.addClass(r.format),i=$("."+r.format,e)):-3===t?(e.removeClass(r.success),e.removeClass(r.empty),e.removeClass(r.format),e.addClass(r.custom),i=$("."+r.custom,e)):(e.removeClass(r.success),e.removeClass(r.empty),e.removeClass(r.format),e.removeClass(r.custom)),i&&i.get(0)&&!i.hasClass(r.active)&&(i.addClass(r.active),setTimeout(function(){i.removeClass(r.active)},3e3))}var r={empty:"empty-err",format:"format-err",custom:"custom-err",success:"input-suc",active:"active"},a=function(e){this.rules=e.rules,this.activeFunc=e.activeFunc||function(){},this.disableFunc=e.disableFunc;var t=this;return this.bind=function(){function e(e){var i,o,r,a,s,u,c,l,d,g=$(e.target).attr("data-checkerindex").split(",");if(a=$(e.target),s=a.parents(".form-control"),u=a.val(),!u)return void n(s,a.attr("data-notEmpty")?-1:0);for(c=0,l=g.length;l>c;c++)if(d=g[c],i=t.rules[d],o=i.validate,r=i.type,o(u))n(s,1);else if($.trim(u)!=$(e.target).attr("placeholder"))return n(s,r),void t.disableFunc();t.checkOthers(a)?t.activeFunc():t.disableFunc()}function i(e){var i,r,a,s,u,c,l,d=$(e.target).attr("data-checkerindex").split(",");for(r=$(e.target),a=r.parents(".form-control"),s=r.val(),u=0,c=d.length;c>u;u++)if(l=d[u],i=t.rules[l].validate,!i(s))return void t.disableFunc();o(r),n(a,0)}function o(e){t.checkOthers(e)?t.activeFunc():t.disableFunc()}for(var r,a=t.rules.length,s=0;a>s;s++){r=t.rules[s],r.type=r.type||-2;var u=r.vTar,c=u.attr("data-checkerindex")||"",l=!1;c.length>0&&(c+=",",l=!0),c+=s,u.attr("data-checkerindex",c),l||("text"===u.attr("type")||"password"===u.attr("type"))&&(u.bind("input propertychange keyup",i),u.bind("blur",e))}},this.checkOthers=function(e){var t=this,i=t.rules.length;if(1===i)return!0;for(var o=0;i>o;o++){var n=t.rules[o];if(o!=e.attr("data-checkerindex")&&!n.validate(n.vTar.val()))return!1}return!0},this.checkAll=function(e){for(var i=t.rules,o=i.length,r=0,a=0;o>a;a++){var s,u=i[a].validate,c=i[a].vTar,l=c.parents(".form-control");c.val()?u(c.val())?(r++,n(l,0),s=void 0):s=1:s=e?void 0:0}return r===o},this.addRule=function(e){var t=this;t.rules=t.rules.concat(e),t.checkAll()?t.activeFunc():t.disableFunc(),this.bind()},this};i.FormChecker=a,i.checkAll=o,i.showCheckResult=n},{}],19:[function(e,t,i){function o(e){n=$("body"),r=$("#"+u.headerTitle),s=e,c.localize(),c.setTitle(),l.bind()}var n,r,a=e("../database/wizCenter"),s=null,u={headerTitle:"header-title"},c={localize:function(){},setTitle:function(e){r&&a.bizInfo&&(e=e||a.bizInfo.biz_name,r.text(e),r.attr("title",e))}},l={bind:function(){}};t.exports={init:o,setTitle:c.setTitle}},{"../database/wizCenter":9}],20:[function(e,t,i){function o(e){n=$("body"),r=$("#"+s.mainLoadingContent),a=e,c.localize(),l.bind()}var n,r,a=null,s={mainLoadingContent:"loading-content"},u={loadingContent:"loading-content",loading:"page-loading",active:"active"},c={localize:function(){},show:function(e,t){$("#"+e+" ."+u.loadingContent).addClass(u.active),t.addClass(u.loading)},hide:function(e,t){t.removeClass(u.loading),$("#"+e+" ."+u.loadingContent).removeClass(u.active)}},l={bind:function(){}};t.exports={init:o,show:c.show,hide:c.hide}},{}],21:[function(e,t,i){function o(){return this}var n=e("../database/wizCenter");o.prototype.init=function(){this.bindEvent();var e=wizUI.util.getCookieOptions(),t=wizUI.util.getUrlParam("token");t&&wizUI.util.cookie("token",t,e),wizUI.support.history?this.push({token:""},!1):t&&location.replace(window.location.href.replace(/([\?|&])token=[^&]*[&]?/gi,"$1").replace(/[&|\?]$/,""))},o.prototype.bindEvent=function(){var e=this;$(window).bind(wizUI.support.history?"popstate":"hashchange",function(){e.frameTrigger()})},o.prototype.trigger=function(){return $(window).trigger(wizUI.support.history?"popstate":"hashchange"),this},o.prototype.frameTrigger=function(){n.userInfo&&r()};var r=function(){};o.prototype.setAnalyticsFrame=function(e){return wizUI.util.isFunction(e)&&(r=e),this},o.prototype.push=function(e,t){var i,o,n,r,a,s,u=location.hash||location.search;u=u.replace(/\?|#/,"&");var c=u;r=[];for(i in e)if(e.hasOwnProperty(i)){if(a=new RegExp("&("+i+"=([^&]*))"),s=u.match(a),o=e[i],n=i+"="+encodeURIComponent(o),!o&&!s)continue;if(s&&s[1]===n)continue;u=u.replace(a,""),e[i]&&r.push(n)}return 0===r.length&&c==u?this:(u=r.join("&")+u,0===u.indexOf("&")&&(u=u.substr(1)),wizUI.support.history?history.pushState(null,"","?"+u):location.href="#"+u,t&&this.trigger(),this)},t.exports=new o},{"../database/wizCenter":9}],22:[function(e,t,i){function o(e){n=$("body"),a=$("#"+X.loginArea),s=$("#"+X.loginBtn),u=$("#"+X.userIdLogin),c=$("#"+X.passwordLogin),g=$("#"+X.rememberMe),p=$("#"+X.forgetlink),l=u.closest(".form-control"),d=c.closest(".form-control"),m=$("#"+X.wechatLogin),f=$("#"+X.userIdReg),h=f.closest(".form-control"),b=$("#"+X.passwordReg),w=$("#"+X.regOpenBtn),z=$("#"+X.registerInvitedArea),_=$("#"+X.invitedCode),v=$("#"+X.main),C=$("#"+X.toReg),I=$("#"+X.toLogin),y=$("#"+X.loginCheckcodearea),M=$("#"+X.registerCheckcodearea),k=$("#"+X.loginCheckcode),L=$("#"+X.registerCheckcode),G=$("#"+X.openIdLogin),B=$("#"+X.recBizModal),r=$("#"+X.verifyEmail),S=$("#"+X.gotoOpenBizBtn),T=$("#"+X.counntdownText),O=$("#"+X.gotoWebClientLink),D=$("#"+X.oauthKuaipanBtn),U=$("#"+X.oauthKuaipanModal),P=e,_WIZ_CONFIG.oem.getData("HideRegister")&&$("#toReg-guide").hide(),_WIZ_CONFIG.oem.getData("HideSocialLogin")&&G.hide(),_WIZ_CONFIG.oem.getData("HideForgotPassword")||p.removeClass(ee.hide).attr("href",A.url.common.resetPasswordApply);var t,i,o=[],F=_WIZ_CONFIG.oem.getData("CustomLink");if(F){for(t in F)F.hasOwnProperty(t)&&(i=F[t],o.push('<li><a href="',i.url,'", target="_blank">',i.label,"</a></li>"));$("#customLink").append(o.join(""))}te.init(),ie.bind()}var n,r,a,s,u,c,l,d,g,p,m,f,h,b,w,z,_,v,C,I,y,M,k,L,G,B,S,T,O,D,U,F,x,P,W=e("locale"),N=e("../../util/GlobalUtil"),A=e("../../../config/wizConf"),E=e("../../database/wizCenter"),R=e("../../viewer-common/formChecker"),Z=R.FormChecker,H=R.checkAll,V=wizUI.util.getUrlParams(),q={isBiz:V.isbiz,inviteCode:V.i||V.icode||wizUI.util.cookie("iCode"),isAddToBizGroup:!!wizUI.util.cookie("isinvited")},j=!1,K=wizUI.util.getCookieOptions(),Q={},Y={retryCount:0,firstRegCheckCode:!0,firstLoginCheckCode:!0,login:!1},X={loginArea:"loginarea",registerArea:"registerarea",registerInvitedArea:"register-icode-area",loginBtn:"loginbtn",userIdLogin:"login-wizID",passwordLogin:"login-password",userIdReg:"register-wizID",passwordReg:"register-password",regOpenBtn:"regopenbtn",invitedCode:"invited-code",forgetlink:"forgetlink",main:"main",toReg:"toregister",toLogin:"toLogin",loginCheckcodearea:"login-checkcodearea",registerCheckcodearea:"register-checkcodearea",loginCheckcode:"login-checkcode",registerCheckcode:"register-checkcode",openIdLogin:"openid-login",rememberMe:"remember-me",wechatLogin:"wechat-login",wechatLogo:"wechatLogo",recBizModal:"rec-biz",gotoOpenBizBtn:"goto-openbiz-btn",counntdownText:"cd-text",gotoWebClientLink:"goto-webclient",verifyEmail:"verify-email-tip",oauthKuaipanModal:"oauth-kuaipan-modal",oauthKuaipanBtn:"oauth-kuaipan-btn"},J={userID:"wizID",certNO:"CertNo"},ee={active:"active",floatLabelActive:"fl-active",hide:"hide",disabled:"disabled",success:"success",pass:"pass",notPass:"notpass",login:"login",register:"register",formControl:"form-control"},te={init:function(){te.localize(),te.setInviteCode(),te.initLoginArea(),te.initRegArea(),wizUI.Placeholder.init(),te.weixinLogin()},weixinLogin:function(){new WxLogin({id:"wechat-qrcode",appid:A.api.weixin.appid,scope:"snsapi_login",redirect_uri:encodeURIComponent(location.origin+A.url.user.oauth+"?p=login&client_type=webClient"),href:encodeURIComponent(location.origin+"/layout/css/layout_wechat-qrcode.b6f81589.css?"+(new Date).valueOf()),state:""}),$("iframe").height(320)},localize:function(){w.html(q.isAddToBizGroup?W.common.label.joinTeam:W.register.label.reg)},setInviteCode:function(){q.inviteCode&&(_.text(q.inviteCode),z.removeClass("hide"))},initLoginArea:function(){wizUI.FloatLabel.init($("#"+X.loginArea)),E.userId&&(u.val(E.userId),u.parents("."+ee.formControl).addClass(ee.floatLabelActive)),te.initLoginFormChecker()},initLoginFormChecker:function(){F=[{vTar:u,validate:N.verifyEmpty},{vTar:c,validate:function(e){return N.checkValidPasswd(e,1,100)}}];var e={rules:F,activeFunc:function(){s.removeClass(ee.disabled)},disableFunc:function(){s.addClass(ee.disabled)}};x=new Z(e),x.bind()},initRegArea:function(){wizUI.FloatLabel.init($("#"+X.registerArea)),E.userId&&(f.val(E.userId),f.parents("."+ee.formControl).addClass(ee.floatLabelActive)),te.initRegFormChecker()},initRegFormChecker:function(){Y.regRules=[{vTar:f,validate:N.verifyEmail},{vTar:f,validate:function(e){return!N.verifyMyWizEmail(e)},type:-3},{vTar:b,validate:N.checkValidPasswd}];var e={rules:Y.regRules,activeFunc:function(){w.removeClass(ee.disabled)},disableFunc:function(){w.addClass(ee.disabled)}};Y.regOpenChecker=new Z(e),Y.regOpenChecker.bind()},goRedirect:function(){var e=wizUI.util.getUrlParam("redirectUrl");return(e=decodeURIComponent(e))?(e=0===e.indexOf("http://")||0===e.indexOf("https://")?e:location.protocol+e,window.location.href=e,!0):!1},goResetPassword:function(){p.attr("href",A.url.common.resetPasswordApply+"?email="+encodeURIComponent(u.val()))},showRegister:function(){return document.title=W.register.title,_WIZ_CONFIG.oem.getData("HideRegister")?void te.showLogin():void v.attr("class",ee.register)},showLogin:function(){if(document.title=W.login.title,E.token){if(te.goRedirect())return;oe.getBizInfo()}v.attr("class",ee.login)},setLoginDisable:function(e){e===!1?(te.setDisable(s,!1),te.setDisableForInput(X.loginArea,!1)):(te.setDisable(s,!0),te.setDisableForInput(X.loginArea,!0))},setRegisterDisable:function(e){e===!1?(te.setDisable(w,!1),te.setDisableForInput(X.registerArea,!1)):(te.setDisable(w,!0),te.setDisableForInput(X.registerArea,!0))},setDisable:function(e,t){t===!1?e.removeClass(ee.disabled):e.addClass(ee.disabled)},setDisableForInput:function(e,t){var i=$("#"+e+" input");t===!1?i.removeAttr(ee.disabled):i.attr(ee.disabled,ee.disabled)},setCaptchaImg:function(e,t){var i=A.url.common.captchaImg+t+"?width=100&height=40&ts=";e.find("img").attr("src",i+(new Date).valueOf()).unbind().bind("click",function(e){$(e.target).attr("src",i+(new Date).valueOf())})},goToGuidePage:function(){window.location=A.url.biz.guide},goToManagerPage:function(){window.location=A.url.biz.manage},goToWebClient:function(){delete V.user_id,delete V.email,delete V.isBiz,delete V.icode,delete V.p,window.location=wizUI.util.isEmptyObj(V)?A.url.user.note:wizUI.util.setUrlParams(A.url.user.note,V)},recmmandBiz:function(){B.addClass(ee.active)},routeAccordingToParam:function(e){q.isBiz?e?te.goToManagerPage():te.goToGuidePage():e?te.goToWebClient():q.isAddToBizGroup?te.goToWebClient():j?(ie.bindRecommend(),te.recmmandBiz()):te.goToWebClient()},loginEmailBlur:function(){R.showCheckResult(d,0),R.showCheckResult(l,0),""===u.val()&&l.removeClass("success")},showKuaipanModal:function(){U.addClass(ee.active)},hideKuaipanModal:function(){U.removeClass(ee.active)},showWeixinQrcode:function(){return m.hasClass(ee.active)?void te.hideWeixinQrcode():(ie.bindAutoHideWeixinQrcode(),m.addClass(ee.active),void te.hideKuaipanModal())},hideWeixinQrcode:function(){m.removeClass(ee.active),ie.unbindAutoHideWeixinQrcode()}},ie={bind:function(){C.bind("click",te.showRegister),I.bind("click",te.showLogin),p.bind("click",te.goResetPassword),u.bind("blur",te.loginEmailBlur),$(".item a",G).each(function(e,t){var i=$(t),o=i.attr("data-open-type"),n='_actionPush("ThirdPart", "T-'+o+'", "", ""); window.open("'+A.api.oauth.bind[i.attr("data-open-type")]+'&client_type=webClient",  "_blank", "top=200,left=400,width=630,height=470,directories=no,menubar=no,toolbar=no")';"kuaipan"==o?(i.on("click",te.showKuaipanModal),$("#oauth-kuaipan-btn").attr("onclick",n).on("click",te.hideKuaipanModal)):"wechat"==o?i.on("click",te.showWeixinQrcode):i.attr("onclick",n)}),s.click(function(){return ie.handler.login(F),!1}),w.click(ie.handler.register),c.bind("keyup",function(e){13==e.keyCode&&s.trigger("click")}),k.bind("keyup",function(e){13==e.keyCode&&s.trigger("click")}),b.bind("keyup",function(e){13==e.keyCode&&w.trigger("click")}),L.bind("keyup",function(e){13==e.keyCode&&w.trigger("click")}),ie.regEmailBlur()},bindRecommend:function(){S.on("click",function(){_actionPush("SignupSucc","S-ToTeam","",""),setTimeout(function(){te.goToGuidePage()},500)}),r.text(W.login.label.goVerifyEmail.replace("$1",u.val())),O.on("click",function(){_actionPush("SignupSucc","S-ToWeb","",""),setTimeout(function(){te.goToWebClient()},500)})},bindAutoHideWeixinQrcode:function(){n.bind("click",ie.handler.hideWeixinQrcode)},unbindAutoHideWeixinQrcode:function(){n.unbind("click",ie.handler.hideWeixinQrcode)},handler:{register:function(){if(w.hasClass(ee.disabled)||w.hasClass(ee.notPass))return!1;if(Y.login)return ie.handler.loginForReg(),!1;if(!H(Y.regRules))return w.addClass(ee.disabled),!1;te.setRegisterDisable(!0);var e=f.val(),t=b.val(),i={email:e,password:t};return q.inviteCode&&(i.invite_code=q.inviteCode),Y.checkCodeId&&(i.captcha_id=Y.checkCodeId,i.captcha=L.val()),oe.register(i,ie.callback.register),Y.checkCodeId?_actionPush("Signup","S-Captcha","",""):_actionPush("Signup","S-NoCaptcha","",""),!1},login:function(e){if(s.hasClass(ee.disabled))return!1;var t=u.val(),i=c.val();if(wizUI.util.cookie("isinvited",null,K),H(e)){te.setLoginDisable(!0);var o={user_id:t,password:i};Q.checkCodeId&&(o.checkcode_id=Q.checkCodeId,o.jcaptcha_response=k.val());var n=function(e){ie.callback.login(e)};oe.login(o,n),g.get(0).checked===!0?_actionPush("Login","L-AutoLogin","",""):_actionPush("Login","L-ManualLogin","","")}else te.setLoginDisable(!1),te.setDisable(s,!0);return!1},loginAfterReg:function(){wizUI.util.cookie("iCode",null,K),wizUI.util.cookie("isinvited",null,K);var e={user_id:f.val(),password:b.val()};return Y.firstLoginCheckCode||(e.checkcode_id=Y.checkCodeId,e.jcaptcha_response=L.val()),oe.login(e,ie.callback.loginAfterReg),!1},hideWeixinQrcode:function(e){var t=$(e.target);t.parents("#"+X.wechatLogin).length||t.attr("id")===X.wechatLogin||t.parents("#"+X.wechatLogo).length||t.attr("id")===X.wechatLogo||te.hideWeixinQrcode()}},callback:{register:function(e){var t="";if(e){if(200==e.code)return j=!0,void ie.handler.loginAfterReg();if(L.val(""),Y.checkCodeId=N.getCaptchaCodeId(),te.setCaptchaImg(M,Y.checkCodeId),366==e.code){Y.firstRegCheckCode?(P.showErrorMessage({msg:W.register.err.maxTimes}),Y.firstRegCheckCode=!1,M.show()):P.showErrorMessage({msg:W.common.err.checkCode}),M.addClass(ee.active),L.removeAttr(ee.disabled);var i={vTar:L,validate:function(){var e=L.val();return e.length>3}};Y.regOpenChecker.addRule(i)}t=332==e.code?W.register.err.maxTimesForIP:31e3==e.code?W.register.err.accountExist:429==e.code?W.common.err[429]:W.register.err.fail}else t=W.common.err.server;P.showErrorMessage({msg:t}),te.setRegisterDisable(!1)},login:function(e){if(e){if("200"==e.code){if(P.clearToken(),P.setToken(e.token),E.token=e.token,oe.setLoginCookie(e),te.goRedirect())return;return void(q.isBiz?oe.getBizInfo():te.routeAccordingToParam(!1))}"488"==e.code?P.showErrorMessage({msg:W.login.err.maxTimes}):(R.showCheckResult(d,-3),R.showCheckResult(l,-3))}else P.showErrorMessage({msg:W.common.err.server});te.setLoginDisable(!1)},loginAfterReg:function(e){if(e){if("200"==e.code){if(P.clearToken(),P.setToken(e.token),oe.setLoginCookie(e),te.goRedirect())return;return void te.routeAccordingToParam()}if("488"==e.code)return Y.login=!0,void P.showErrorMessage({msg:W.login.err.maxTimes});te.showLogin()}else P.showErrorMessage({msg:W.common.err.server})},getBizInfo:function(e,t){e&&("200"==e.code&&1==e.biz_status?te.routeAccordingToParam(!0):"404"==e.code||"200"==e.code&&0===e.biz_status?te.routeAccordingToParam(!1):"301"==e.code&&(P.clearToken(),a.show(),te.setDisable(s,!1),te.setDisableForInput(X.loginArea,!1)))}},regEmailBlur:function(){function e(){w.removeClass(ee.notPass),h.removeClass(ee.notPass),h.addClass(ee.pass)}function t(){h.removeClass(ee.success),w.addClass(ee.disabled),h.removeClass(ee.pass),h.addClass(ee.notPass),w.addClass(ee.notPass)}f.bind("blur",function(){return h.removeClass("pass notpass"),f.val()?void setTimeout(function(){h.hasClass(ee.success)&&P.models.user.checkUserId(f.val(),function(i){200==i.code?"true"!==i.is_set?e():t():e()})},10):void h.removeClass(ee.success)})}},oe={getBizInfo:function(){P.models.bizInfo.getBase({},"",ie.callback.getBizInfo)},register:function(e,t){E.userId=e.email,u.val(E.userId),P.models.user.register(e,t)},login:function(e,t){E.userId=e.user_id,f.val(E.userId),P.models.user.login(e,t)},setLoginCookie:function(e){var t=wizUI.util.getCookieOptions();t.expires=g.get(0).checked===!0?14:0,wizUI.util.cookie(J.userID,$.trim(u.val()),t),wizUI.util.cookie(J.certNO,e.cookie_str,t)}};t.exports={init:o,showLogin:te.showLogin,showRegister:te.showRegister}},{"../../../config/wizConf":4,"../../database/wizCenter":9,"../../util/GlobalUtil":15,"../../viewer-common/formChecker":18,locale:"locale"}]},{},[5]);j	      UɭUɭ;vUc   6:http://note.wiznote.com/libs/entity/login.0001e0ac.js necko:classified 1 request-method GET response-head HTTP/1.1 200 OK
Server: nginx
Date: Tue, 11 Aug 2015 08:10:09 GMT
Content-Type: application/x-javascript
Content-Length: 91736
Last-Modified: Mon, 10 Aug 2015 09:03:06 GMT
Etag: "55c868ca-16658"
Accept-Ranges: bytes
 uncompressed-len 0  fX